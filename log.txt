      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +10ms
  inngest:01K5HHZQTDHJCGRD08H73DFSFV executing step "update-database" +1ms
üìù Updating parsed flyer item ktsj38DyiYTHLLIg1o7Y
üìù Updating parsed flyer item UOjPfoqvEszrSvJVcJxZ
  inngest:01K5HHZY7AB21H23F84QQ6882W created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZY7AB21H23F84QQ6882W existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HHZY7AB21H23F84QQ6882W starting V1 execution +1ms
  inngest:01K5HHZY7AB21H23F84QQ6882W checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'dJomE2XLth1WAUvzNzuZ',
    matchedProducts: 0,
    autoApproved: false
  }
} +6ms
  inngest:01K5HHZY7AB21H23F84QQ6882W result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZY24XCSW0PZ855KFT8DN',
      name: 'flyer/product-match',
      ts: 1758304663620,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZY7AB21H23F84QQ6882W',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'dJomE2XLth1WAUvzNzuZ',
    matchedProducts: 0,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 28ms
üîç Update data structure check: {"matchedProducts":[],"matchingStatus":"completed","autoApprovalStatus":"failed","autoApprovalFailedAt":{"_seconds":1758304695,"_nanoseconds":63000000},"autoApprovalFailureReason":"No suitable product...
  inngest:01K5HHZS1Q43N49126H9DSEK90 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZS1GTJXR4M5SNK98ABBJ',
      name: 'flyer/product-match',
      ts: 1758304658480,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZS1Q43N49126H9DSEK90',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'The "name match" rule requires an exact match between the flyer item name and the database product name.  While both products are Savex Premium Detergent 5.5kg, the flyer item specifies "Color & Care", while the database product is "Fresh Universal". This difference prevents the names from being an exact match, thus failing the auto-approval rule.',
      confidence: 0.7,
      productId: null
    }
  }
} +3s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 3356ms
‚úÖ Successfully updated parsed flyer item uHYZSFWFOClMoaiJwKhZ
‚úÖ Successfully updated parsed flyer item ebgMHzV40q853qm6GGZS
  inngest:01K5HHZNKDCQD9SZ4BPN707YSA result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZNGVJH7E6TJ93NGF2WJ5',
      name: 'flyer/extract-images',
      ts: 1758304654875,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZNKDCQD9SZ4BPN707YSA',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +621ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 681ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +1ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 starting V1 execution +0ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 executing step "save-matches-and-update-status" +1ms
üìù Updating parsed flyer item QjSGsp3fisEu8Jmz7MP0
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully updated parsed flyer item MfnrxqxvwAkl2PkD2vew
  inngest:01K5HJ0359D31GHK9WYKNPGCQ3 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ02YMA35Z7DY7WJPN1D2C',
      name: 'flyer/product-match',
      ts: 1758304668628,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ0359D31GHK9WYKNPGCQ3',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +629ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 652ms
  inngest:01K5HHZNKDCQD9SZ4BPN707YSA created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZNKDCQD9SZ4BPN707YSA existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZNKDCQD9SZ4BPN707YSA starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'uiUmyiaM5eaHaBvExszk', itemCount: 2 }
  inngest:01K5HHZNKDCQD9SZ4BPN707YSA checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'uiUmyiaM5eaHaBvExszk',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +8ms
  inngest:01K5HHZNKDCQD9SZ4BPN707YSA result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZNGVJH7E6TJ93NGF2WJ5',
      name: 'flyer/extract-images',
      ts: 1758304654875,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZNKDCQD9SZ4BPN707YSA',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'uiUmyiaM5eaHaBvExszk',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +0ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 55ms
  inngest:01K5HJ0359D31GHK9WYKNPGCQ3 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ0359D31GHK9WYKNPGCQ3 existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HJ0359D31GHK9WYKNPGCQ3 starting V1 execution +0ms
  inngest:01K5HJ0359D31GHK9WYKNPGCQ3 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'MfnrxqxvwAkl2PkD2vew',
    matchedProducts: 0,
    autoApproved: false
  }
} +10ms
  inngest:01K5HJ0359D31GHK9WYKNPGCQ3 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ02YMA35Z7DY7WJPN1D2C',
      name: 'flyer/product-match',
      ts: 1758304668628,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ0359D31GHK9WYKNPGCQ3',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'MfnrxqxvwAkl2PkD2vew',
    matchedProducts: 0,
    autoApproved: false
  }
} +0ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 29ms
üîç Update data structure check: {"matchedProducts":[{"productId":"00GAOMXjQNgFXhjef5NA","relevanceScore":0.7,"matchReason":"Strong name and brand match, same size, but different variant ('Color & Care' vs 'Fresh Universal')","can_au...
‚úÖ Successfully updated parsed flyer item UOjPfoqvEszrSvJVcJxZ
‚úÖ Successfully updated parsed flyer item ktsj38DyiYTHLLIg1o7Y
  inngest:01K5HHZQTDHJCGRD08H73DFSFV result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZQKGRDB7FA6FTCPJSMYT',
      name: 'flyer/extract-images',
      ts: 1758304657008,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZQTDHJCGRD08H73DFSFV',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +650ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 706ms
  inngest:01K5HHZQTDHJCGRD08H73DFSFV created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZQTDHJCGRD08H73DFSFV existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZQTDHJCGRD08H73DFSFV starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'IK22EwFNyrXNxJ0COzrE', itemCount: 2 }
  inngest:01K5HHZQTDHJCGRD08H73DFSFV checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'IK22EwFNyrXNxJ0COzrE',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +7ms
  inngest:01K5HHZQTDHJCGRD08H73DFSFV result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZQKGRDB7FA6FTCPJSMYT',
      name: 'flyer/extract-images',
      ts: 1758304657008,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZQTDHJCGRD08H73DFSFV',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'IK22EwFNyrXNxJ0COzrE',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +0ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 47ms
‚úÖ Successfully updated parsed flyer item QjSGsp3fisEu8Jmz7MP0
  inngest:01K5HHZS1Q43N49126H9DSEK90 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZS1GTJXR4M5SNK98ABBJ',
      name: 'flyer/product-match',
      ts: 1758304658480,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZS1Q43N49126H9DSEK90',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +760ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 790ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 starting V1 execution +0ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'QjSGsp3fisEu8Jmz7MP0',
    matchedProducts: 2,
    autoApproved: false
  }
} +4ms
  inngest:01K5HHZS1Q43N49126H9DSEK90 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZS1GTJXR4M5SNK98ABBJ',
      name: 'flyer/product-match',
      ts: 1758304658480,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZS1Q43N49126H9DSEK90',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'QjSGsp3fisEu8Jmz7MP0',
    matchedProducts: 2,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 21ms
‚úÖ Gemini API call completed at 2025-09-19T17:58:16.561Z
üìÑ Received response of length: 2028 characters
ü§ñ Raw Gemini response length: 2028
‚úÖ Found 9 valid matches after filtering
üèÅ Product matching completed with 9 matches
Match #1: productId=00P1AnRDmLigXbNmk9LQ, score=0.00, can_auto_merge=false
Match #2: productId=04NlBvxAeE4CUd3XqUhJ, score=0.00, can_auto_merge=false
Match #3: productId=32ceEIPBGP0bigSKU9nR, score=0.00, can_auto_merge=false
Match #4: productId=00GAOMXjQNgFXhjef5NA, score=0.00, can_auto_merge=false
Match #5: productId=015WZy9isbKoLpURfywP, score=0.00, can_auto_merge=false
Match #6: productId=017YNh2rj86Hd7A7zmoc, score=0.00, can_auto_merge=false
Match #7: productId=024JQwVkethXqfZ72B6g, score=0.00, can_auto_merge=false
Match #8: productId=02LJRT6qs5HsQj7Ce0u6, score=0.00, can_auto_merge=false
Match #9: productId=042NTZa93JKCVNQdgDrP, score=0.00, can_auto_merge=false
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01CQS494XM4Y3YCBA7X3',
      name: 'flyer/product-match',
      ts: 1758304667031,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01DFYZNHVKFG0RTYCE2M',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +8s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 8408ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M starting V1 execution +0ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +6ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M executing step "check-auto-approval" +1ms
üîç Fetching all active auto-approval rules using admin SDK
‚úÖ Gemini API call completed at 2025-09-19T17:58:16.976Z
üìÑ Received response of length: 2187 characters
ü§ñ Raw Gemini response length: 2187
‚úÖ Found 9 valid matches after filtering
üèÅ Product matching completed with 9 matches
Match #1: productId=00P1AnRDmLigXbNmk9LQ, score=0.00, can_auto_merge=false
Match #2: productId=04NlBvxAeE4CUd3XqUhJ, score=0.00, can_auto_merge=false
Match #3: productId=32ceEIPBGP0bigSKU9nR, score=0.00, can_auto_merge=false
Match #4: productId=00GAOMXjQNgFXhjef5NA, score=0.00, can_auto_merge=false
Match #5: productId=015WZy9isbKoLpURfywP, score=0.00, can_auto_merge=false
Match #6: productId=017YNh2rj86Hd7A7zmoc, score=0.00, can_auto_merge=false
Match #7: productId=024JQwVkethXqfZ72B6g, score=0.00, can_auto_merge=false
Match #8: productId=02LJRT6qs5HsQj7Ce0u6, score=0.00, can_auto_merge=false
Match #9: productId=042NTZa93JKCVNQdgDrP, score=0.00, can_auto_merge=false
  inngest:01K5HJ01DNETJTDXT90G82JV5D result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01D1RF0C1S22A0R7SYRN',
      name: 'flyer/product-match',
      ts: 1758304667041,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01DNETJTDXT90G82JV5D',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +9s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 8982ms
‚úÖ Found 1 active auto-approval rule(s).
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01CQS494XM4Y3YCBA7X3',
      name: 'flyer/product-match',
      ts: 1758304667031,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01DFYZNHVKFG0RTYCE2M',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'No suitable product matches found to evaluate against rules.',
      confidence: 0,
      productId: null
    }
  }
} +288ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 310ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D starting V1 execution +0ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +4ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D executing step "check-auto-approval" +1ms
üîç Fetching all active auto-approval rules using admin SDK
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M starting V1 execution +0ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +10ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M executing step "save-matches-and-update-status" +2ms
üìù Updating parsed flyer item 5MNfIee8fjbo2zD8qGSH
‚úÖ Gemini API call completed at 2025-09-19T17:58:17.315Z
üìÑ Received response of length: 2505 characters
ü§ñ Raw Gemini response length: 2505
‚úÖ Found 9 valid matches after filtering
üèÅ Product matching completed with 9 matches
Match #1: productId=00P1AnRDmLigXbNmk9LQ, score=0.00, can_auto_merge=false
Match #2: productId=04NlBvxAeE4CUd3XqUhJ, score=0.00, can_auto_merge=false
Match #3: productId=32ceEIPBGP0bigSKU9nR, score=0.00, can_auto_merge=false
Match #4: productId=00GAOMXjQNgFXhjef5NA, score=0.00, can_auto_merge=false
Match #5: productId=015WZy9isbKoLpURfywP, score=0.00, can_auto_merge=false
Match #6: productId=017YNh2rj86Hd7A7zmoc, score=0.00, can_auto_merge=false
Match #7: productId=024JQwVkethXqfZ72B6g, score=0.00, can_auto_merge=false
Match #8: productId=02LJRT6qs5HsQj7Ce0u6, score=0.00, can_auto_merge=false
Match #9: productId=042NTZa93JKCVNQdgDrP, score=0.00, can_auto_merge=false
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01F0SKYGEAAE4389GC47',
      name: 'flyer/product-match',
      ts: 1758304667104,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01NMSNG3MK79EHYZHJSX',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +9s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 9472ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX starting V1 execution +0ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +3ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX executing step "check-auto-approval" +1ms
üîç Fetching all active auto-approval rules using admin SDK
‚úÖ Found 1 active auto-approval rule(s).
  inngest:01K5HJ01DNETJTDXT90G82JV5D result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01D1RF0C1S22A0R7SYRN',
      name: 'flyer/product-match',
      ts: 1758304667041,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01DNETJTDXT90G82JV5D',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'No suitable product matches found to evaluate against rules.',
      confidence: 0,
      productId: null
    }
  }
} +1s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 1485ms
üîç Update data structure check: {"matchedProducts":[],"matchingStatus":"completed","autoApprovalStatus":"failed","autoApprovalFailedAt":{"_seconds":1758304697,"_nanoseconds":171000000},"autoApprovalFailureReason":"No suitable produc...
  inngest:01K5HJ01DNETJTDXT90G82JV5D created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D starting V1 execution +0ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +6ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D executing step "save-matches-and-update-status" +1ms
üìù Updating parsed flyer item V664H5WAOLtbmEd45DdB
‚úÖ Found 1 active auto-approval rule(s).
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01F0SKYGEAAE4389GC47',
      name: 'flyer/product-match',
      ts: 1758304667104,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01NMSNG3MK79EHYZHJSX',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'No suitable product matches found to evaluate against rules.',
      confidence: 0,
      productId: null
    }
  }
} +1s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 1187ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX starting V1 execution +0ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX executing step "save-matches-and-update-status" +1ms
üìù Updating parsed flyer item igext57W1inS3OlXHX4Q
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1027752
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'Hoiq35P3XoS5w55Hf0dM',
  productName: 'Savex Premium Fresh Universal Detergent 5.5kg',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'Hoiq35P3XoS5w55Hf0dM',
  productName: 'Savex Premium Fresh Universal Detergent 5.5kg',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Savex Premium Fresh Universal Detergent 5.5kg. Total so far: 2
üçå FINAL RESULT: Successfully extracted 2 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: 'QjSGsp3fisEu8Jmz7MP0',
    productName: 'Savex Premium Color & Care Detergent 5.5kg',
    hasImageUrl: true,
    imageUrlLength: 1032534,
    confidence: 0.95
  },
  {
    itemId: 'Hoiq35P3XoS5w55Hf0dM',
    productName: 'Savex Premium Fresh Universal Detergent 5.5kg',
    hasImageUrl: true,
    imageUrlLength: 1027774,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 2
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZSZV2QHDQQX2E79GY3DH',
      name: 'flyer/extract-images',
      ts: 1758304659451,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZT1HTGF6PB1RYY5JDMA7',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object] ]
  }
} +36s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 35828ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: '8dTMOr0jeX3pFOBQhsgK', itemCount: 2 }
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +9ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 executing step "process-images" +1ms
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Successfully updated parsed flyer item 5MNfIee8fjbo2zD8qGSH
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01CQS494XM4Y3YCBA7X3',
      name: 'flyer/product-match',
      ts: 1758304667031,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01DFYZNHVKFG0RTYCE2M',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +2s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 1900ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +1ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M starting V1 execution +0ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: '5MNfIee8fjbo2zD8qGSH',
    matchedProducts: 0,
    autoApproved: false
  }
} +11ms
  inngest:01K5HJ01DFYZNHVKFG0RTYCE2M result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01CQS494XM4Y3YCBA7X3',
      name: 'flyer/product-match',
      ts: 1758304667031,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01DFYZNHVKFG0RTYCE2M',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: '5MNfIee8fjbo2zD8qGSH',
    matchedProducts: 0,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 42ms
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: QjSGsp3fisEu8Jmz7MP0
üîç Update data structure check: {"matchedProducts":[],"matchingStatus":"completed","autoApprovalStatus":"failed","autoApprovalFailedAt":{"_seconds":1758304698,"_nanoseconds":526000000},"autoApprovalFailureReason":"No suitable produc...
üîç Update data structure check: {"matchedProducts":[],"matchingStatus":"completed","autoApprovalStatus":"failed","autoApprovalFailedAt":{"_seconds":1758304698,"_nanoseconds":676000000},"autoApprovalFailureReason":"No suitable produc...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'dae6acc5-59df-4382-ba04-f251d0d88413',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
‚úÖ Successfully updated parsed flyer item V664H5WAOLtbmEd45DdB
  inngest:01K5HJ01DNETJTDXT90G82JV5D result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01D1RF0C1S22A0R7SYRN',
      name: 'flyer/product-match',
      ts: 1758304667041,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01DNETJTDXT90G82JV5D',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +2s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 1769ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D starting V1 execution +1ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'V664H5WAOLtbmEd45DdB',
    matchedProducts: 0,
    autoApproved: false
  }
} +5ms
  inngest:01K5HJ01DNETJTDXT90G82JV5D result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01D1RF0C1S22A0R7SYRN',
      name: 'flyer/product-match',
      ts: 1758304667041,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01DNETJTDXT90G82JV5D',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'V664H5WAOLtbmEd45DdB',
    matchedProducts: 0,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 30ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1199804
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'YGjq7MEBgTJyBx3glMYR',
  productName: 'Ariel Pods 60/1',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'YGjq7MEBgTJyBx3glMYR',
  productName: 'Ariel Pods 60/1',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Ariel Pods 60/1. Total so far: 3
üçå FINAL RESULT: Successfully extracted 3 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: 'TsPesB676kDbBvsAik0z',
    productName: 'Ariel Powder 5.2kg',
    hasImageUrl: true,
    imageUrlLength: 1195622,
    confidence: 0.95
  },
  {
    itemId: 'R5sHBaAjAeYb2B3023XV',
    productName: 'Ariel Liquid 3.6L',
    hasImageUrl: true,
    imageUrlLength: 968198,
    confidence: 0.95
  },
  {
    itemId: 'YGjq7MEBgTJyBx3glMYR',
    productName: 'Ariel Pods 60/1',
    hasImageUrl: true,
    imageUrlLength: 1199826,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 3
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZK70QW8QCWN3N2JB0TWY',
      name: 'flyer/extract-images',
      ts: 1758304652512,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZKCGMB3KSCCSHS4ATHYT',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object] ]
  }
} +47s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 47370ms
‚úÖ Successfully updated parsed flyer item igext57W1inS3OlXHX4Q
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01F0SKYGEAAE4389GC47',
      name: 'flyer/product-match',
      ts: 1758304667104,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01NMSNG3MK79EHYZHJSX',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +3s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 2991ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +1ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX starting V1 execution +0ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'igext57W1inS3OlXHX4Q',
    matchedProducts: 0,
    autoApproved: false
  }
} +6ms
  inngest:01K5HJ01NMSNG3MK79EHYZHJSX result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ01F0SKYGEAAE4389GC47',
      name: 'flyer/product-match',
      ts: 1758304667104,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ01NMSNG3MK79EHYZHJSX',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'igext57W1inS3OlXHX4Q',
    matchedProducts: 0,
    autoApproved: false
  }
} +0ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 29ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'uUjdVb1h0ODP4LyXO4ZB', itemCount: 3 }
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +6ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT executing step "process-images" +1ms
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1173800
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'kjsoi1xK3fxl0Hx3b0QS',
  productName: 'Jacobs Cronat Gold Instant Coffee 100g',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'kjsoi1xK3fxl0Hx3b0QS',
  productName: 'Jacobs Cronat Gold Instant Coffee 100g',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Jacobs Cronat Gold Instant Coffee 100g. Total so far: 2
‚è≥ Rate limiting: waiting 1500ms before next API call...
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: TsPesB676kDbBvsAik0z
‚úÖ Successfully uploaded all optimized images for item: QjSGsp3fisEu8Jmz7MP0
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1062408
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Thomy Mayonnaise. Total so far: 2
‚è≥ Rate limiting: waiting 1500ms before next API call...
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: Hoiq35P3XoS5w55Hf0dM
üçå Processing item 3/3: Jacobs Crema Instant Coffee 100g
üçå Item ID: dJomE2XLth1WAUvzNzuZ
üçå Direct product extraction for: Jacobs Crema Instant Coffee 100g
üçå Item details: {
  id: 'dJomE2XLth1WAUvzNzuZ',
  productName: 'Jacobs Crema Instant Coffee 100g',
  productNameMk: '–à–∞–∫–æ–±—Å –ö—Ä–µ–º–∞ –ò–Ω—Å—Ç–∞–Ω—Ç –ö–∞—Ñ–µ 100–≥'
}
üçå Built enhanced prompt for Jacobs Crema Instant Coffee 100g
üçå Generated prompt for Jacobs Crema Instant Coffee 100g
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2063
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2063
üçå Base64 data length: 134920
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
üçå Processing item 3/5: Tuborg Beer
üçå Item ID: MGdXEzwP6HuZx3nLr2Ln
üçå Direct product extraction for: Tuborg Beer
üçå Item details: {
  id: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  productNameMk: '–¢—É–±–æ—Ä–≥ –ü–∏–≤–æ'
}
üçå Built enhanced prompt for Tuborg Beer
üçå Generated prompt for Tuborg Beer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2023
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2023
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚úÖ Successfully uploaded all optimized images for item: TsPesB676kDbBvsAik0z
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: R5sHBaAjAeYb2B3023XV
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'd9b1260a-df9b-44be-b597-58de3ad6f5df',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
‚úÖ Successfully uploaded all optimized images for item: Hoiq35P3XoS5w55Hf0dM
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZSZV2QHDQQX2E79GY3DH',
      name: 'flyer/extract-images',
      ts: 1758304659451,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZT1HTGF6PB1RYY5JDMA7',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object] ]
  }
} +7s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 6867ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: '8dTMOr0jeX3pFOBQhsgK', itemCount: 2 }
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +6ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 executing step "update-database" +0ms
üìù Updating parsed flyer item QjSGsp3fisEu8Jmz7MP0
üìù Updating parsed flyer item Hoiq35P3XoS5w55Hf0dM
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 347316
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'igext57W1inS3OlXHX4Q',
  productName: 'Paragon By The River Temjanika White Wine',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'igext57W1inS3OlXHX4Q',
  productName: 'Paragon By The River Temjanika White Wine',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Paragon By The River Temjanika White Wine. Total so far: 3
üçå FINAL RESULT: Successfully extracted 3 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: '5MNfIee8fjbo2zD8qGSH',
    productName: 'Paragon By The River Zupljanka White Wine',
    hasImageUrl: true,
    imageUrlLength: 391666,
    confidence: 0.95
  },
  {
    itemId: 'V664H5WAOLtbmEd45DdB',
    productName: 'Paragon By The River La Vie En Rose Wine',
    hasImageUrl: true,
    imageUrlLength: 402334,
    confidence: 0.95
  },
  {
    itemId: 'igext57W1inS3OlXHX4Q',
    productName: 'Paragon By The River Temjanika White Wine',
    hasImageUrl: true,
    imageUrlLength: 347338,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 3
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ02ST3GEC3BSHR7268GVG',
      name: 'flyer/extract-images',
      ts: 1758304668474,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ02WYAB26XJQE7B7CZ0E6',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object] ]
  }
} +35s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 34789ms
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'MmecMEbcU3dtQfeIYKQX', itemCount: 3 }
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 executing step "process-images" +1ms
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: 5MNfIee8fjbo2zD8qGSH
‚úÖ Successfully uploaded all optimized images for item: R5sHBaAjAeYb2B3023XV
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Successfully updated parsed flyer item QjSGsp3fisEu8Jmz7MP0
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: YGjq7MEBgTJyBx3glMYR
‚úÖ Successfully updated parsed flyer item Hoiq35P3XoS5w55Hf0dM
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZSZV2QHDQQX2E79GY3DH',
      name: 'flyer/extract-images',
      ts: 1758304659451,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZT1HTGF6PB1RYY5JDMA7',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +2s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 1876ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: '8dTMOr0jeX3pFOBQhsgK', itemCount: 2 }
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: '8dTMOr0jeX3pFOBQhsgK',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +5ms
  inngest:01K5HHZT1HTGF6PB1RYY5JDMA7 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZSZV2QHDQQX2E79GY3DH',
      name: 'flyer/extract-images',
      ts: 1758304659451,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZT1HTGF6PB1RYY5JDMA7',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: '8dTMOr0jeX3pFOBQhsgK',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 51ms
‚úÖ Successfully uploaded all optimized images for item: 5MNfIee8fjbo2zD8qGSH
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: V664H5WAOLtbmEd45DdB
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'feb7b2c9-5f87-4a22-b82b-632c554b5542',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
‚úÖ Successfully uploaded all optimized images for item: YGjq7MEBgTJyBx3glMYR
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZK70QW8QCWN3N2JB0TWY',
      name: 'flyer/extract-images',
      ts: 1758304652512,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZKCGMB3KSCCSHS4ATHYT',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object], [Object] ]
  }
} +8s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 8219ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +1ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'uUjdVb1h0ODP4LyXO4ZB', itemCount: 3 }
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT executing step "update-database" +1ms
üìù Updating parsed flyer item TsPesB676kDbBvsAik0z
üìù Updating parsed flyer item R5sHBaAjAeYb2B3023XV
üìù Updating parsed flyer item YGjq7MEBgTJyBx3glMYR
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully uploaded all optimized images for item: V664H5WAOLtbmEd45DdB
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: igext57W1inS3OlXHX4Q
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully updated parsed flyer item TsPesB676kDbBvsAik0z
‚úÖ Successfully updated parsed flyer item R5sHBaAjAeYb2B3023XV
‚úÖ Successfully updated parsed flyer item YGjq7MEBgTJyBx3glMYR
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZK70QW8QCWN3N2JB0TWY',
      name: 'flyer/extract-images',
      ts: 1758304652512,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZKCGMB3KSCCSHS4ATHYT',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +3s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 3002ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'uUjdVb1h0ODP4LyXO4ZB', itemCount: 3 }
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'uUjdVb1h0ODP4LyXO4ZB',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +8ms
  inngest:01K5HHZKCGMB3KSCCSHS4ATHYT result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZK70QW8QCWN3N2JB0TWY',
      name: 'flyer/extract-images',
      ts: 1758304652512,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZKCGMB3KSCCSHS4ATHYT',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'uUjdVb1h0ODP4LyXO4ZB',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 63ms
‚úÖ Successfully uploaded all optimized images for item: igext57W1inS3OlXHX4Q
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ02ST3GEC3BSHR7268GVG',
      name: 'flyer/extract-images',
      ts: 1758304668474,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ02WYAB26XJQE7B7CZ0E6',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object], [Object] ]
  }
} +7s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 7207ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'MmecMEbcU3dtQfeIYKQX', itemCount: 3 }
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 executing step "update-database" +1ms
üìù Updating parsed flyer item 5MNfIee8fjbo2zD8qGSH
üìù Updating parsed flyer item V664H5WAOLtbmEd45DdB
üìù Updating parsed flyer item igext57W1inS3OlXHX4Q
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'ceac5f8f-ec0a-4ada-9771-a8ab967cd5ba',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully updated parsed flyer item 5MNfIee8fjbo2zD8qGSH
‚úÖ Successfully updated parsed flyer item igext57W1inS3OlXHX4Q
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1101844
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'dJomE2XLth1WAUvzNzuZ',
  productName: 'Jacobs Crema Instant Coffee 100g',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'dJomE2XLth1WAUvzNzuZ',
  productName: 'Jacobs Crema Instant Coffee 100g',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Jacobs Crema Instant Coffee 100g. Total so far: 3
üçå FINAL RESULT: Successfully extracted 3 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: 'jenw3WebXUTkZlNkwj8i',
    productName: 'Jacobs Monarch Instant Coffee 100g',
    hasImageUrl: true,
    imageUrlLength: 1073702,
    confidence: 0.95
  },
  {
    itemId: 'kjsoi1xK3fxl0Hx3b0QS',
    productName: 'Jacobs Cronat Gold Instant Coffee 100g',
    hasImageUrl: true,
    imageUrlLength: 1173822,
    confidence: 0.95
  },
  {
    itemId: 'dJomE2XLth1WAUvzNzuZ',
    productName: 'Jacobs Crema Instant Coffee 100g',
    hasImageUrl: true,
    imageUrlLength: 1101866,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 3
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZZRH98Q6S8ZH7HXAS1B8',
      name: 'flyer/extract-images',
      ts: 1758304665361,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZZY8TT3YDKAZMFN58JBX',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object] ]
  }
} +46s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 46160ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'L2aJP8Lds7HtmjzhKHnv', itemCount: 3 }
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +7ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX executing step "process-images" +1ms
üîß Optimizing image for Flutter app...
‚úÖ Successfully updated parsed flyer item V664H5WAOLtbmEd45DdB
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ02ST3GEC3BSHR7268GVG',
      name: 'flyer/extract-images',
      ts: 1758304668474,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ02WYAB26XJQE7B7CZ0E6',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +3s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 2965ms
üìê Original image: 1408x736
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'MmecMEbcU3dtQfeIYKQX', itemCount: 3 }
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'MmecMEbcU3dtQfeIYKQX',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +6ms
  inngest:01K5HJ02WYAB26XJQE7B7CZ0E6 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ02ST3GEC3BSHR7268GVG',
      name: 'flyer/extract-images',
      ts: 1758304668474,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ02WYAB26XJQE7B7CZ0E6',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'MmecMEbcU3dtQfeIYKQX',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 43ms
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: jenw3WebXUTkZlNkwj8i
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1043388
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Tuborg Beer. Total so far: 3
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 4/5: Vero Mop
üçå Item ID: 1Z3uI3OL04X5mOw0K0wC
üçå Direct product extraction for: Vero Mop
üçå Item details: {
  id: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  productNameMk: '–í–µ—Ä–æ –ú–æ–ø'
}
üçå Built enhanced prompt for Vero Mop
üçå Generated prompt for Vero Mop
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2017
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2017
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '1484ef09-4238-4680-86dc-1d40915bc1b5',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
‚úÖ Successfully uploaded all optimized images for item: jenw3WebXUTkZlNkwj8i
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: kjsoi1xK3fxl0Hx3b0QS
 ‚óã Compiling /api/products/search ...
 ‚úì Compiled /api/products/search in 727ms (906 modules)
REDIS_URL environment variable is not set, caching will be disabled.
üîç Enhanced search for products matching: Lazar
‚ö†Ô∏è No exact match found. Proceeding to keyword-based search.
üìä SEARCH_START - Product matching search initiated with parameters: {
  productName: 'Lazar',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  limit: 20
}
üîç Extracting keywords from: "Lazar"
üîç Additional texts: undefined
üîç Cleaned text: "lazar"
üîç Base words extracted: [ 'lazar' ]
üîç Final unique keywords: [ 'lazar' ]
üîç Keyword extraction debug: {
  productName: 'Lazar',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  extractedEnglishKeywords: [ 'lazar' ],
  extractedMacedonianKeywords: []
}
üìä SEARCH_KEYWORDS - Extracted keywords for search: {
  productName: 'Lazar',
  englishKeywords: 'lazar',
  englishKeywordCount: 1,
  macedonianKeywords: '',
  macedonianKeywordCount: 0,
  keywordExtractionMethod: 'standard tokenization with stopword removal'
}
üîç Searching with keywords: lazar
üìã Search parameters: {
  productName: 'Lazar',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  englishKeywords: [ 'lazar' ],
  macedonianKeywords: [],
  allKeywords: [ 'lazar' ],
  limitedKeywords: [ 'lazar' ]
}
üîç Testing products collection access...
üìä Products collection accessible: 1 test doc(s) found
üìä Sample product structure: {
  id: ' 00GAOMXjQNgFXhjef5NA',
  name: 'Savex Premium Fresh Universal Detergent 5.5kg',
  hasEnglishNameKeywords: true,
  hasMacedonianname: true,
  hasKeywords: false
}
üîç Stage 1: Searching englishNameKeywords
üìä Stage 1: englishNameKeywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 1: englishNameKeywords: Found 0 results
üîç Stage 3: Searching albeniannameKeywords
‚úÖ Successfully uploaded all optimized images for item: kjsoi1xK3fxl0Hx3b0QS
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: dJomE2XLth1WAUvzNzuZ
üìä Stage 3: albeniannameKeywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 3: albeniannameKeywords: Found 0 results
üîç Stage 4: Searching keywords array
üìä Stage 4: keywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 4: keywords: Found 0 results
üîç Stage 5: Searching tags array
üçå NanoBananaService initialized with Gemini 2.5 Flash Image Preview
üîß Initializing Inngest serve handler...
üìä Functions to register: 4
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '2f0974bb-1162-46e9-81be-5f873d74b127',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 142ms
üìä Stage 5: tags: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 5: tags: Found 0 results
üîç Stage 6: Searching name field
üîç Stage 6a: Trying exact name match for: "Lazar"
üìä Stage 6a: Exact name match found 0 results
üìä Stage 6a: exact name match: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 6a: exact name match: Found 0 results
üîç Stage 6b: Searching name field with keyword: "lazar"
‚úÖ Successfully uploaded all optimized images for item: dJomE2XLth1WAUvzNzuZ
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZZRH98Q6S8ZH7HXAS1B8',
      name: 'flyer/extract-images',
      ts: 1758304665361,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZZY8TT3YDKAZMFN58JBX',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object], [Object] ]
  }
} +11s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 10797ms
üìä Stage 6b: Keyword "lazar" found 0 results
üìä Stage 6b: name field keyword "lazar": Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 6b: name field keyword "lazar": Found 0 results
üîç Stage 8: Searching albenianname field
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +1ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'L2aJP8Lds7HtmjzhKHnv', itemCount: 3 }
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +17ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX executing step "update-database" +1ms
üìù Updating parsed flyer item jenw3WebXUTkZlNkwj8i
üìù Updating parsed flyer item kjsoi1xK3fxl0Hx3b0QS
üìù Updating parsed flyer item dJomE2XLth1WAUvzNzuZ
üìä Stage 8: albenianname field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 8: albenianname field: Found 0 results
üîç Stage 9: Searching superMarketName field
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 355416
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Vero Mop. Total so far: 4
‚è≥ Rate limiting: waiting 1500ms before next API call...
üìä Stage 9: superMarketName field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 9: superMarketName field: Found 0 results
üîç Stage 10: Searching description field (fallback)
‚úÖ Successfully updated parsed flyer item jenw3WebXUTkZlNkwj8i
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '5dcf87a7-27f5-4085-a2c6-6822db68e1a8',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
‚úÖ Successfully updated parsed flyer item kjsoi1xK3fxl0Hx3b0QS
‚úÖ Successfully updated parsed flyer item dJomE2XLth1WAUvzNzuZ
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZZRH98Q6S8ZH7HXAS1B8',
      name: 'flyer/extract-images',
      ts: 1758304665361,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZZY8TT3YDKAZMFN58JBX',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +3s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 3007ms
üìä Stage 10: description field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 10: description field: Found 0 results
‚úÖ Found 0 potential product matches
‚ùå SEARCH_ZERO_RESULTS - No matches found for product: Lazar
üìä SEARCH_FAILURE_ANALYSIS - Search failed with parameters: {
  productName: 'Lazar',
  productNameMk: undefined,
  keywordsUsed: 'lazar',
  searchStagesAttempted: 'englishNameKeywords, macedoniannameKeywords, albeniannameKeywords, keywords, tags, name, macedonianname, albenianname, superMarketName, description',
  possibleReasons: 'Product not in database, Keyword extraction failed to capture relevant terms, Language/character encoding mismatch, Product name too generic or too specific, Database indexing issues'
}
 GET /api/products/search?q=Lazar 200 in 9894ms
üçå Processing item 5/5: Lazar Alur Gew√ºrztraminer
üçå Item ID: MfnrxqxvwAkl2PkD2vew
üçå Direct product extraction for: Lazar Alur Gew√ºrztraminer
üçå Item details: {
  id: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  productNameMk: '–õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
}
üçå Built enhanced prompt for Lazar Alur Gew√ºrztraminer
üçå Generated prompt for Lazar Alur Gew√ºrztraminer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2051
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2051
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX created new V1 execution for run; discovering steps +0ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'L2aJP8Lds7HtmjzhKHnv', itemCount: 3 }
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'L2aJP8Lds7HtmjzhKHnv',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +11ms
  inngest:01K5HHZZY8TT3YDKAZMFN58JBX result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HHZZRH98Q6S8ZH7HXAS1B8',
      name: 'flyer/extract-images',
      ts: 1758304665361,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HHZZY8TT3YDKAZMFN58JBX',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'L2aJP8Lds7HtmjzhKHnv',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 63ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'a6f8f107-f33f-4254-81ea-c857ec15cca3',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
üîç Enhanced search for products matching: Lazar
‚ö†Ô∏è No exact match found. Proceeding to keyword-based search.
üìä SEARCH_START - Product matching search initiated with parameters: {
  productName: 'Lazar',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  limit: 20
}
üîç Extracting keywords from: "Lazar"
üîç Additional texts: undefined
üîç Cleaned text: "lazar"
üîç Base words extracted: [ 'lazar' ]
üîç Final unique keywords: [ 'lazar' ]
üîç Keyword extraction debug: {
  productName: 'Lazar',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  extractedEnglishKeywords: [ 'lazar' ],
  extractedMacedonianKeywords: []
}
üìä SEARCH_KEYWORDS - Extracted keywords for search: {
  productName: 'Lazar',
  englishKeywords: 'lazar',
  englishKeywordCount: 1,
  macedonianKeywords: '',
  macedonianKeywordCount: 0,
  keywordExtractionMethod: 'standard tokenization with stopword removal'
}
üîç Searching with keywords: lazar
üìã Search parameters: {
  productName: 'Lazar',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  englishKeywords: [ 'lazar' ],
  macedonianKeywords: [],
  allKeywords: [ 'lazar' ],
  limitedKeywords: [ 'lazar' ]
}
üîç Testing products collection access...
üìä Products collection accessible: 1 test doc(s) found
üìä Sample product structure: {
  id: ' 00GAOMXjQNgFXhjef5NA',
  name: 'Savex Premium Fresh Universal Detergent 5.5kg',
  hasEnglishNameKeywords: true,
  hasMacedonianname: true,
  hasKeywords: false
}
üîç Stage 1: Searching englishNameKeywords
üìä Stage 1: englishNameKeywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 1: englishNameKeywords: Found 0 results
üîç Stage 3: Searching albeniannameKeywords
üìä Stage 3: albeniannameKeywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 3: albeniannameKeywords: Found 0 results
üîç Stage 4: Searching keywords array
üìä Stage 4: keywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 4: keywords: Found 0 results
üîç Stage 5: Searching tags array
üìä Stage 5: tags: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 5: tags: Found 0 results
üîç Stage 6: Searching name field
üîç Stage 6a: Trying exact name match for: "Lazar"
üìä Stage 6a: Exact name match found 0 results
üìä Stage 6a: exact name match: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 6a: exact name match: Found 0 results
üîç Stage 6b: Searching name field with keyword: "lazar"
üìä Stage 6b: Keyword "lazar" found 0 results
üìä Stage 6b: name field keyword "lazar": Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 6b: name field keyword "lazar": Found 0 results
üîç Stage 8: Searching albenianname field
üìä Stage 8: albenianname field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 8: albenianname field: Found 0 results
üîç Stage 9: Searching superMarketName field
üìä Stage 9: superMarketName field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 9: superMarketName field: Found 0 results
üîç Stage 10: Searching description field (fallback)
üìä Stage 10: description field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 10: description field: Found 0 results
‚úÖ Found 0 potential product matches
‚ùå SEARCH_ZERO_RESULTS - No matches found for product: Lazar
üìä SEARCH_FAILURE_ANALYSIS - Search failed with parameters: {
  productName: 'Lazar',
  productNameMk: undefined,
  keywordsUsed: 'lazar',
  searchStagesAttempted: 'englishNameKeywords, macedoniannameKeywords, albeniannameKeywords, keywords, tags, name, macedonianname, albenianname, superMarketName, description',
  possibleReasons: 'Product not in database, Keyword extraction failed to capture relevant terms, Language/character encoding mismatch, Product name too generic or too specific, Database indexing issues'
}
 GET /api/products/search?q=Lazar 200 in 4268ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '93254a6e-1750-458c-945a-bb9c94f6a40a',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 28ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 851296
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Lazar Alur Gew√ºrztraminer. Total so far: 5
üçå FINAL RESULT: Successfully extracted 5 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: '9x2Ghrh6ctZDGfu7BJiB',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    hasImageUrl: true,
    imageUrlLength: 1261778,
    confidence: 0.95
  },
  {
    itemId: 'eBJTXkUgVmsg91pisFlZ',
    productName: 'Thomy Mayonnaise',
    hasImageUrl: true,
    imageUrlLength: 1062430,
    confidence: 0.95
  },
  {
    itemId: 'MGdXEzwP6HuZx3nLr2Ln',
    productName: 'Tuborg Beer',
    hasImageUrl: true,
    imageUrlLength: 1043410,
    confidence: 0.95
  },
  {
    itemId: '1Z3uI3OL04X5mOw0K0wC',
    productName: 'Vero Mop',
    hasImageUrl: true,
    imageUrlLength: 355438,
    confidence: 0.95
  },
  {
    itemId: 'MfnrxqxvwAkl2PkD2vew',
    productName: 'Lazar Alur Gew√ºrztraminer',
    hasImageUrl: true,
    imageUrlLength: 851318,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 5
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HJ0457CXE5ECN44DW6BAGK result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ0414NRN1W3HT5ZT22GVE',
      name: 'flyer/extract-images',
      ts: 1758304669732,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ0457CXE5ECN44DW6BAGK',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object], [Object], [Object] ]
  }
} +1m
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 70444ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '5ef54e18-cbe3-403b-912b-b90100c9685a',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 21ms
‚è±Ô∏è Gemini API call timed out after 90 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'e8344c2f-8ec0-42c5-8abd-d7a609ba3d8f',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '9bd53902-df96-42f1-99e0-947990ca2648',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'b7329f06-1a66-41ad-bffb-ee8e14a686d9',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
  inngest:01K5HJ0457CXE5ECN44DW6BAGK created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK existing state keys: [
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +1ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'DiQECJbZn7qL5WFBomwF', itemCount: 5 }
  inngest:01K5HJ0457CXE5ECN44DW6BAGK checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +6ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK executing step "extract-with-ai" +1ms
üçå Starting NANO BANANA clean product image extraction for 5 items
üçå Config: {
  removeText: true,
  removePromotionalElements: true,
  backgroundStyle: 'white',
  productCentering: true,
  shadowGeneration: true,
  qualityEnhancement: true
}
üçå Flyer image data length: 277043
üçå Parsed items: [
  {
    id: '9x2Ghrh6ctZDGfu7BJiB',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    productNameMk: '–ê—Ä–∏–µ–ª –ü—Ä–∞–≤ + –ê—Ä–∏–µ–ª –¢–µ—á–µ–Ω (–ö–û–ú–ë–û)'
  },
  {
    id: 'eBJTXkUgVmsg91pisFlZ',
    productName: 'Thomy Mayonnaise',
    productNameMk: '–¢–æ–º–∏ –ú–∞—ò–æ–Ω–µ–∑'
  },
  {
    id: 'MGdXEzwP6HuZx3nLr2Ln',
    productName: 'Tuborg Beer',
    productNameMk: '–¢—É–±–æ—Ä–≥ –ü–∏–≤–æ'
  },
  {
    id: '1Z3uI3OL04X5mOw0K0wC',
    productName: 'Vero Mop',
    productNameMk: '–í–µ—Ä–æ –ú–æ–ø'
  },
  {
    id: 'MfnrxqxvwAkl2PkD2vew',
    productName: 'Lazar Alur Gew√ºrztraminer',
    productNameMk: '–õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
  }
]
üçå Processing item 1/5: Ariel Powder + Ariel Liquid (COMBO)
üçå Item ID: 9x2Ghrh6ctZDGfu7BJiB
üçå Direct product extraction for: Ariel Powder + Ariel Liquid (COMBO)
üçå Item details: {
  id: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  productNameMk: '–ê—Ä–∏–µ–ª –ü—Ä–∞–≤ + –ê—Ä–∏–µ–ª –¢–µ—á–µ–Ω (–ö–û–ú–ë–û)'
}
üçå Built enhanced prompt for Ariel Powder + Ariel Liquid (COMBO)
üçå Generated prompt for Ariel Powder + Ariel Liquid (COMBO)
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2068
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2068
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '9452785e-115b-4535-a296-3abbb7acde75',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '6dbdb530-d8b6-4b58-a998-9681f80281d5',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '868f629f-175e-4495-8cdb-4673ecc28b37',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1234524
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Ariel Powder + Ariel Liquid (COMBO). Total so far: 1
‚è≥ Rate limiting: waiting 1500ms before next API call...
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
‚è±Ô∏è Gemini API call timed out after 90 seconds
üçå Processing item 2/5: Thomy Mayonnaise
üçå Item ID: eBJTXkUgVmsg91pisFlZ
üçå Direct product extraction for: Thomy Mayonnaise
üçå Item details: {
  id: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  productNameMk: '–¢–æ–º–∏ –ú–∞—ò–æ–Ω–µ–∑'
}
üçå Built enhanced prompt for Thomy Mayonnaise
üçå Generated prompt for Thomy Mayonnaise
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2029
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2029
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '6a38b52d-4bdd-4b5c-87dc-7e92dbbfd422',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'df9a714c-611d-45f2-a757-cf23dd12f027',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '5838eb4f-fd80-446e-a75a-100ff2e8627d',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 29ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1044480
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Thomy Mayonnaise. Total so far: 2
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 3/5: Tuborg Beer
üçå Item ID: MGdXEzwP6HuZx3nLr2Ln
üçå Direct product extraction for: Tuborg Beer
üçå Item details: {
  id: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  productNameMk: '–¢—É–±–æ—Ä–≥ –ü–∏–≤–æ'
}
üçå Built enhanced prompt for Tuborg Beer
üçå Generated prompt for Tuborg Beer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2023
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2023
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '294f9fe6-70e7-4f24-8084-959145799b85',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'd4f4769f-b26a-4254-a926-bf9c8c70722b',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 31ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '0a79c7d6-c6d6-4fae-b743-60f9072b15e0',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1118768
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Tuborg Beer. Total so far: 3
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 4/5: Vero Mop
üçå Item ID: 1Z3uI3OL04X5mOw0K0wC
üçå Direct product extraction for: Vero Mop
üçå Item details: {
  id: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  productNameMk: '–í–µ—Ä–æ –ú–æ–ø'
}
üçå Built enhanced prompt for Vero Mop
üçå Generated prompt for Vero Mop
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2017
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2017
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '54c9f8bd-80f9-45b5-9b4c-98c94941b969',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 19ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'a6df4a53-4a4a-46a5-be97-e384d4863878',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 21ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 348944
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Vero Mop. Total so far: 4
‚è≥ Rate limiting: waiting 1500ms before next API call...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '67237226-9dc9-4017-b322-439bb54b7eb8',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 22ms
üçå Processing item 5/5: Lazar Alur Gew√ºrztraminer
üçå Item ID: MfnrxqxvwAkl2PkD2vew
üçå Direct product extraction for: Lazar Alur Gew√ºrztraminer
üçå Item details: {
  id: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  productNameMk: '–õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
}
üçå Built enhanced prompt for Lazar Alur Gew√ºrztraminer
üçå Generated prompt for Lazar Alur Gew√ºrztraminer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2051
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2051
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '420b766a-7ad5-490d-8a2d-c418f3610941',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 26ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '85ee0a3a-0af2-4756-8df6-26867bddd1a2',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 30ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 851316
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Lazar Alur Gew√ºrztraminer. Total so far: 5
üçå FINAL RESULT: Successfully extracted 5 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: '9x2Ghrh6ctZDGfu7BJiB',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    hasImageUrl: true,
    imageUrlLength: 1234546,
    confidence: 0.95
  },
  {
    itemId: 'eBJTXkUgVmsg91pisFlZ',
    productName: 'Thomy Mayonnaise',
    hasImageUrl: true,
    imageUrlLength: 1044502,
    confidence: 0.95
  },
  {
    itemId: 'MGdXEzwP6HuZx3nLr2Ln',
    productName: 'Tuborg Beer',
    hasImageUrl: true,
    imageUrlLength: 1118790,
    confidence: 0.95
  },
  {
    itemId: '1Z3uI3OL04X5mOw0K0wC',
    productName: 'Vero Mop',
    hasImageUrl: true,
    imageUrlLength: 348966,
    confidence: 0.95
  },
  {
    itemId: 'MfnrxqxvwAkl2PkD2vew',
    productName: 'Lazar Alur Gew√ºrztraminer',
    hasImageUrl: true,
    imageUrlLength: 851338,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 5
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HJ0457CXE5ECN44DW6BAGK result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ0414NRN1W3HT5ZT22GVE',
      name: 'flyer/extract-images',
      ts: 1758304669732,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ0457CXE5ECN44DW6BAGK',
    attempt: 1,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object], [Object], [Object] ]
  }
} +1m
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 70069ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'c7672aa7-a31b-4bf4-bea9-c80785bf25d7',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 36ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '1e8f8ede-f9ac-4154-95b2-6dc46fe9632b',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'befe33be-b21a-4fcd-a0ea-6e89ee378c2c',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 30ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '1b6808d1-c29a-471d-8e8f-04bd06fffbe7',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '6dadfd3e-0347-448b-b26e-e51de92f26aa',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '78d4fced-2af1-4c5a-9e75-f1041a284f02',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 30ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK existing state keys: [
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +1ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'DiQECJbZn7qL5WFBomwF', itemCount: 5 }
  inngest:01K5HJ0457CXE5ECN44DW6BAGK checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +7ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK executing step "extract-with-ai" +0ms
üçå Starting NANO BANANA clean product image extraction for 5 items
üçå Config: {
  removeText: true,
  removePromotionalElements: true,
  backgroundStyle: 'white',
  productCentering: true,
  shadowGeneration: true,
  qualityEnhancement: true
}
üçå Flyer image data length: 277043
üçå Parsed items: [
  {
    id: '9x2Ghrh6ctZDGfu7BJiB',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    productNameMk: '–ê—Ä–∏–µ–ª –ü—Ä–∞–≤ + –ê—Ä–∏–µ–ª –¢–µ—á–µ–Ω (–ö–û–ú–ë–û)'
  },
  {
    id: 'eBJTXkUgVmsg91pisFlZ',
    productName: 'Thomy Mayonnaise',
    productNameMk: '–¢–æ–º–∏ –ú–∞—ò–æ–Ω–µ–∑'
  },
  {
    id: 'MGdXEzwP6HuZx3nLr2Ln',
    productName: 'Tuborg Beer',
    productNameMk: '–¢—É–±–æ—Ä–≥ –ü–∏–≤–æ'
  },
  {
    id: '1Z3uI3OL04X5mOw0K0wC',
    productName: 'Vero Mop',
    productNameMk: '–í–µ—Ä–æ –ú–æ–ø'
  },
  {
    id: 'MfnrxqxvwAkl2PkD2vew',
    productName: 'Lazar Alur Gew√ºrztraminer',
    productNameMk: '–õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
  }
]
üçå Processing item 1/5: Ariel Powder + Ariel Liquid (COMBO)
üçå Item ID: 9x2Ghrh6ctZDGfu7BJiB
üçå Direct product extraction for: Ariel Powder + Ariel Liquid (COMBO)
üçå Item details: {
  id: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  productNameMk: '–ê—Ä–∏–µ–ª –ü—Ä–∞–≤ + –ê—Ä–∏–µ–ª –¢–µ—á–µ–Ω (–ö–û–ú–ë–û)'
}
üçå Built enhanced prompt for Ariel Powder + Ariel Liquid (COMBO)
üçå Generated prompt for Ariel Powder + Ariel Liquid (COMBO)
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2068
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2068
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'bad47c72-f600-4d09-bbcd-b50ba38563ba',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 34ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'e51aa644-ba33-4fae-92cd-bd61f9df0dd1',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '99888df6-c574-472c-b797-23f7e2797aef',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
 ‚úì Compiled in 2.4s (1292 modules)
REDIS_URL environment variable is not set, caching will be disabled.
üçå NanoBananaService initialized with Gemini 2.5 Flash Image Preview
üîß Initializing Inngest serve handler...
üìä Functions to register: 4
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'e71ad5f8-1131-4e3b-8e17-6d2c75facd03',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 1717ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1174008
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Ariel Powder + Ariel Liquid (COMBO). Total so far: 1
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 2/5: Thomy Mayonnaise
üçå Item ID: eBJTXkUgVmsg91pisFlZ
üçå Direct product extraction for: Thomy Mayonnaise
üçå Item details: {
  id: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  productNameMk: '–¢–æ–º–∏ –ú–∞—ò–æ–Ω–µ–∑'
}
üçå Built enhanced prompt for Thomy Mayonnaise
üçå Generated prompt for Thomy Mayonnaise
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2029
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2029
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '975cb991-7004-4ec4-b499-3e4d56e74068',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '71560998-e62e-4b42-99e3-14d0ed121679',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 22ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1083536
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Thomy Mayonnaise. Total so far: 2
‚è≥ Rate limiting: waiting 1500ms before next API call...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '2ddf0f80-ae82-4a70-87de-2889b3235aae',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
üçå Processing item 3/5: Tuborg Beer
üçå Item ID: MGdXEzwP6HuZx3nLr2Ln
üçå Direct product extraction for: Tuborg Beer
üçå Item details: {
  id: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  productNameMk: '–¢—É–±–æ—Ä–≥ –ü–∏–≤–æ'
}
üçå Built enhanced prompt for Tuborg Beer
üçå Generated prompt for Tuborg Beer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2023
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2023
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'eb63d92f-63a2-40a4-84de-80823d7fc7fe',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 37ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '0cdfb25e-0b0f-4b3a-a1ce-53e377eaaf12',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 30ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'f2980e63-98eb-4f6b-8c6f-bdd7a9313f59',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 32ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1082412
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Tuborg Beer. Total so far: 3
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 4/5: Vero Mop
üçå Item ID: 1Z3uI3OL04X5mOw0K0wC
üçå Direct product extraction for: Vero Mop
üçå Item details: {
  id: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  productNameMk: '–í–µ—Ä–æ –ú–æ–ø'
}
üçå Built enhanced prompt for Vero Mop
üçå Generated prompt for Vero Mop
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2017
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2017
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
 ‚úì Compiled in 1737ms (1292 modules)
REDIS_URL environment variable is not set, caching will be disabled.
üçå NanoBananaService initialized with Gemini 2.5 Flash Image Preview
üîß Initializing Inngest serve handler...
üìä Functions to register: 4
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '167045e7-a754-4362-8b98-e55e6ea8db8f',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 719ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '0ee083fb-4f47-4172-bbe3-8d9e02cff15c',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 280100
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Vero Mop. Total so far: 4
‚è≥ Rate limiting: waiting 1500ms before next API call...
 ‚óã Compiling /api/products/search ...
 ‚úì Compiled /api/products/search in 532ms (906 modules)
REDIS_URL environment variable is not set, caching will be disabled.
üîç Enhanced search for products matching: Nile
üçå Processing item 5/5: Lazar Alur Gew√ºrztraminer
üçå Item ID: MfnrxqxvwAkl2PkD2vew
üçå Direct product extraction for: Lazar Alur Gew√ºrztraminer
üçå Item details: {
  id: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  productNameMk: '–õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
}
üçå Built enhanced prompt for Lazar Alur Gew√ºrztraminer
üçå Generated prompt for Lazar Alur Gew√ºrztraminer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2051
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2051
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚ö†Ô∏è No exact match found. Proceeding to keyword-based search.
üìä SEARCH_START - Product matching search initiated with parameters: {
  productName: 'Nile',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  limit: 20
}
üîç Extracting keywords from: "Nile"
üîç Additional texts: undefined
üîç Cleaned text: "nile"
üîç Base words extracted: [ 'nile' ]
üîç Final unique keywords: [ 'nile' ]
üîç Keyword extraction debug: {
  productName: 'Nile',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  extractedEnglishKeywords: [ 'nile' ],
  extractedMacedonianKeywords: []
}
üìä SEARCH_KEYWORDS - Extracted keywords for search: {
  productName: 'Nile',
  englishKeywords: 'nile',
  englishKeywordCount: 1,
  macedonianKeywords: '',
  macedonianKeywordCount: 0,
  keywordExtractionMethod: 'standard tokenization with stopword removal'
}
üîç Searching with keywords: nile
üìã Search parameters: {
  productName: 'Nile',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  englishKeywords: [ 'nile' ],
  macedonianKeywords: [],
  allKeywords: [ 'nile' ],
  limitedKeywords: [ 'nile' ]
}
üîç Testing products collection access...
üìä Products collection accessible: 1 test doc(s) found
üìä Sample product structure: {
  id: ' 00GAOMXjQNgFXhjef5NA',
  name: 'Savex Premium Fresh Universal Detergent 5.5kg',
  hasEnglishNameKeywords: true,
  hasMacedonianname: true,
  hasKeywords: false
}
üîç Stage 1: Searching englishNameKeywords
üìä Stage 1: englishNameKeywords: Found 1 results
üìä SEARCH_STAGE_RESULTS - Stage 1: englishNameKeywords: Found 1 results
üîç Stage 1: englishNameKeywords - Product found: {
  id: '042NTZa93JKCVNQdgDrP',
  name: 'Nile Tecent Detergent 2.7l',
  macedonianname: '–ù–∏–ª–∞ —Ç–µ—á–µ–Ω –¥–µ—Ç–µ—Ä–≥–µ–Ω—Ç 2.7–ª',
  albenianname: 'Nile Tecent Detergjent 2.7L'
}
‚úÖ Stage 1: englishNameKeywords - Added unique product: Nile Tecent Detergent 2.7l
üîç Stage 3: Searching albeniannameKeywords
üìä Stage 3: albeniannameKeywords: Found 1 results
üìä SEARCH_STAGE_RESULTS - Stage 3: albeniannameKeywords: Found 1 results
üîç Stage 3: albeniannameKeywords - Product found: {
  id: '042NTZa93JKCVNQdgDrP',
  name: 'Nile Tecent Detergent 2.7l',
  macedonianname: '–ù–∏–ª–∞ —Ç–µ—á–µ–Ω –¥–µ—Ç–µ—Ä–≥–µ–Ω—Ç 2.7–ª',
  albenianname: 'Nile Tecent Detergjent 2.7L'
}
üîÑ Stage 3: albeniannameKeywords - Skipped duplicate product: Nile Tecent Detergent 2.7l
üîç Stage 4: Searching keywords array
üìä Stage 4: keywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 4: keywords: Found 0 results
üîç Stage 5: Searching tags array
üìä Stage 5: tags: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 5: tags: Found 0 results
üîç Stage 6: Searching name field
üîç Stage 6a: Trying exact name match for: "Nile"
üìä Stage 6a: Exact name match found 0 results
üìä Stage 6a: exact name match: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 6a: exact name match: Found 0 results
üîç Stage 6b: Searching name field with keyword: "nile"
üçå NanoBananaService initialized with Gemini 2.5 Flash Image Preview
üîß Initializing Inngest serve handler...
üìä Functions to register: 4
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'c08670ff-04f4-4bc7-9e90-08823c789323',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 71ms
üìä Stage 6b: Keyword "nile" found 0 results
üìä Stage 6b: name field keyword "nile": Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 6b: name field keyword "nile": Found 0 results
üîç Stage 8: Searching albenianname field
üìä Stage 8: albenianname field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 8: albenianname field: Found 0 results
üîç Stage 9: Searching superMarketName field
üìä Stage 9: superMarketName field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 9: superMarketName field: Found 0 results
üîç Stage 10: Searching description field (fallback)
üìä Stage 10: description field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 10: description field: Found 0 results
‚úÖ Found 1 potential product matches
üìä SEARCH_SUCCESS - Found 1 matches for product: Nile
üìä SEARCH_RESULT_SUMMARY - Top matches: [
  {
    id: '042NTZa93JKCVNQdgDrP',
    name: 'Nile Tecent Detergent 2.7l',
    macedonianname: '–ù–∏–ª–∞ —Ç–µ—á–µ–Ω –¥–µ—Ç–µ—Ä–≥–µ–Ω—Ç 2.7–ª',
    matchedVia: 'Stage 1: englishNameKeywords'
  }
]
 GET /api/products/search?q=Nile 200 in 5712ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'c49dda44-19f5-4bcc-9dca-0f3d0d1576f3',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
üîç Enhanced search for products matching: Jackon
‚ö†Ô∏è No exact match found. Proceeding to keyword-based search.
üìä SEARCH_START - Product matching search initiated with parameters: {
  productName: 'Jackon',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  limit: 20
}
üîç Extracting keywords from: "Jackon"
üîç Additional texts: undefined
üîç Cleaned text: "jackon"
üîç Base words extracted: [ 'jackon' ]
üîç Final unique keywords: [ 'jackon' ]
üîç Keyword extraction debug: {
  productName: 'Jackon',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  extractedEnglishKeywords: [ 'jackon' ],
  extractedMacedonianKeywords: []
}
üìä SEARCH_KEYWORDS - Extracted keywords for search: {
  productName: 'Jackon',
  englishKeywords: 'jackon',
  englishKeywordCount: 1,
  macedonianKeywords: '',
  macedonianKeywordCount: 0,
  keywordExtractionMethod: 'standard tokenization with stopword removal'
}
üîç Searching with keywords: jackon
üìã Search parameters: {
  productName: 'Jackon',
  productNameMk: undefined,
  additionalInfo: undefined,
  additionalInfoMk: undefined,
  englishKeywords: [ 'jackon' ],
  macedonianKeywords: [],
  allKeywords: [ 'jackon' ],
  limitedKeywords: [ 'jackon' ]
}
üîç Testing products collection access...
üìä Products collection accessible: 1 test doc(s) found
üìä Sample product structure: {
  id: ' 00GAOMXjQNgFXhjef5NA',
  name: 'Savex Premium Fresh Universal Detergent 5.5kg',
  hasEnglishNameKeywords: true,
  hasMacedonianname: true,
  hasKeywords: false
}
üîç Stage 1: Searching englishNameKeywords
üìä Stage 1: englishNameKeywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 1: englishNameKeywords: Found 0 results
üîç Stage 3: Searching albeniannameKeywords
üìä Stage 3: albeniannameKeywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 3: albeniannameKeywords: Found 0 results
üîç Stage 4: Searching keywords array
üìä Stage 4: keywords: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 4: keywords: Found 0 results
üîç Stage 5: Searching tags array
üìä Stage 5: tags: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 5: tags: Found 0 results
üîç Stage 6: Searching name field
üîç Stage 6a: Trying exact name match for: "Jackon"
üìä Stage 6a: Exact name match found 0 results
üìä Stage 6a: exact name match: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 6a: exact name match: Found 0 results
üîç Stage 6b: Searching name field with keyword: "jackon"
üìä Stage 6b: Keyword "jackon" found 0 results
üìä Stage 6b: name field keyword "jackon": Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 6b: name field keyword "jackon": Found 0 results
üîç Stage 8: Searching albenianname field
üìä Stage 8: albenianname field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 8: albenianname field: Found 0 results
üîç Stage 9: Searching superMarketName field
üìä Stage 9: superMarketName field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 9: superMarketName field: Found 0 results
üîç Stage 10: Searching description field (fallback)
üìä Stage 10: description field: Found 0 results
üìä SEARCH_STAGE_RESULTS - Stage 10: description field: Found 0 results
‚úÖ Found 0 potential product matches
‚ùå SEARCH_ZERO_RESULTS - No matches found for product: Jackon
üìä SEARCH_FAILURE_ANALYSIS - Search failed with parameters: {
  productName: 'Jackon',
  productNameMk: undefined,
  keywordsUsed: 'jackon',
  searchStagesAttempted: 'englishNameKeywords, macedoniannameKeywords, albeniannameKeywords, keywords, tags, name, macedonianname, albenianname, superMarketName, description',
  possibleReasons: 'Product not in database, Keyword extraction failed to capture relevant terms, Language/character encoding mismatch, Product name too generic or too specific, Database indexing issues'
}
 GET /api/products/search?q=Jackon 200 in 3547ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 870040
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Lazar Alur Gew√ºrztraminer. Total so far: 5
üçå FINAL RESULT: Successfully extracted 5 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: '9x2Ghrh6ctZDGfu7BJiB',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    hasImageUrl: true,
    imageUrlLength: 1174030,
    confidence: 0.95
  },
  {
    itemId: 'eBJTXkUgVmsg91pisFlZ',
    productName: 'Thomy Mayonnaise',
    hasImageUrl: true,
    imageUrlLength: 1083558,
    confidence: 0.95
  },
  {
    itemId: 'MGdXEzwP6HuZx3nLr2Ln',
    productName: 'Tuborg Beer',
    hasImageUrl: true,
    imageUrlLength: 1082434,
    confidence: 0.95
  },
  {
    itemId: '1Z3uI3OL04X5mOw0K0wC',
    productName: 'Vero Mop',
    hasImageUrl: true,
    imageUrlLength: 280122,
    confidence: 0.95
  },
  {
    itemId: 'MfnrxqxvwAkl2PkD2vew',
    productName: 'Lazar Alur Gew√ºrztraminer',
    hasImageUrl: true,
    imageUrlLength: 870062,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 5
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HJ0457CXE5ECN44DW6BAGK result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ0414NRN1W3HT5ZT22GVE',
      name: 'flyer/extract-images',
      ts: 1758304669732,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ0457CXE5ECN44DW6BAGK',
    attempt: 2,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object], [Object], [Object] ]
  }
} +1m
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 73341ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'ead89895-a5d5-4917-bbdf-9965b46f1afd',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '8001f403-1927-48a9-a7a2-c647c0daf133',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 32ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'bc756de0-21af-46e8-95ad-879eba0221e1',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 31ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'dd9c64cd-60ae-4a18-9e4e-97c585d21bc4',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 29ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'b563e4a5-b927-4a76-90a4-546cc147a13f',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 31ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '1c315dcf-9133-4a59-8f7b-5a8ae2a88288',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '91de9487-d0f8-483a-a8cd-0bb1d24ad160',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 26ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '07918c5f-e8da-4d2a-847b-f1c2dd2b04ac',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '07912ef5-8e87-4e72-a227-2617787689e8',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 36ms
 GET /parsed-items 200 in 486ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '3b417d07-dd98-43e0-8cbd-530b00a0279f',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 47ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'f4cee639-5141-444c-877b-a7c91d70aa9a',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '4063c4bc-e47b-4ad3-aa84-088d17f11e3d',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 22ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '412ac00a-455b-457a-bb04-85c91b4db06a',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '9ef4b4be-4352-4d91-a7d9-59f9cd22494e',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 21ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK created new V1 execution for run; discovering steps +0ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK existing state keys: [
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'DiQECJbZn7qL5WFBomwF', itemCount: 5 }
  inngest:01K5HJ0457CXE5ECN44DW6BAGK checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +11ms
  inngest:01K5HJ0457CXE5ECN44DW6BAGK executing step "extract-with-ai" +2ms
üçå Starting NANO BANANA clean product image extraction for 5 items
üçå Config: {
  removeText: true,
  removePromotionalElements: true,
  backgroundStyle: 'white',
  productCentering: true,
  shadowGeneration: true,
  qualityEnhancement: true
}
üçå Flyer image data length: 277043
üçå Parsed items: [
  {
    id: '9x2Ghrh6ctZDGfu7BJiB',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    productNameMk: '–ê—Ä–∏–µ–ª –ü—Ä–∞–≤ + –ê—Ä–∏–µ–ª –¢–µ—á–µ–Ω (–ö–û–ú–ë–û)'
  },
  {
    id: 'eBJTXkUgVmsg91pisFlZ',
    productName: 'Thomy Mayonnaise',
    productNameMk: '–¢–æ–º–∏ –ú–∞—ò–æ–Ω–µ–∑'
  },
  {
    id: 'MGdXEzwP6HuZx3nLr2Ln',
    productName: 'Tuborg Beer',
    productNameMk: '–¢—É–±–æ—Ä–≥ –ü–∏–≤–æ'
  },
  {
    id: '1Z3uI3OL04X5mOw0K0wC',
    productName: 'Vero Mop',
    productNameMk: '–í–µ—Ä–æ –ú–æ–ø'
  },
  {
    id: 'MfnrxqxvwAkl2PkD2vew',
    productName: 'Lazar Alur Gew√ºrztraminer',
    productNameMk: '–õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
  }
]
üçå Processing item 1/5: Ariel Powder + Ariel Liquid (COMBO)
üçå Item ID: 9x2Ghrh6ctZDGfu7BJiB
üçå Direct product extraction for: Ariel Powder + Ariel Liquid (COMBO)
üçå Item details: {
  id: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  productNameMk: '–ê—Ä–∏–µ–ª –ü—Ä–∞–≤ + –ê—Ä–∏–µ–ª –¢–µ—á–µ–Ω (–ö–û–ú–ë–û)'
}
üçå Built enhanced prompt for Ariel Powder + Ariel Liquid (COMBO)
üçå Generated prompt for Ariel Powder + Ariel Liquid (COMBO)
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2068
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2068
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '8920fd90-b6cb-4f36-a049-e257daddf1d5',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '80520990-77f1-4e78-92c4-1d3e5f7522c7',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '6e508e06-b4ef-4bfa-a8dc-9ee4452ef5ac',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'ed978060-42de-4ad1-9306-c849d55ab086',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '42b1fb78-cce9-4b9a-af3b-d23f25b7fedb',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 21ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1243496
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: '9x2Ghrh6ctZDGfu7BJiB',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Ariel Powder + Ariel Liquid (COMBO). Total so far: 1
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 2/5: Thomy Mayonnaise
üçå Item ID: eBJTXkUgVmsg91pisFlZ
üçå Direct product extraction for: Thomy Mayonnaise
üçå Item details: {
  id: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  productNameMk: '–¢–æ–º–∏ –ú–∞—ò–æ–Ω–µ–∑'
}
üçå Built enhanced prompt for Thomy Mayonnaise
üçå Generated prompt for Thomy Mayonnaise
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2029
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2029
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '731675c8-5272-4e92-97e7-b1730ff78643',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '62a20a5a-4a89-4773-9cff-1155ced498f9',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '4807485d-ab88-4c9e-ab84-dbeaace010a2',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 22ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 950412
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'eBJTXkUgVmsg91pisFlZ',
  productName: 'Thomy Mayonnaise',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Thomy Mayonnaise. Total so far: 2
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 3/5: Tuborg Beer
üçå Item ID: MGdXEzwP6HuZx3nLr2Ln
üçå Direct product extraction for: Tuborg Beer
üçå Item details: {
  id: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  productNameMk: '–¢—É–±–æ—Ä–≥ –ü–∏–≤–æ'
}
üçå Built enhanced prompt for Tuborg Beer
üçå Generated prompt for Tuborg Beer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2023
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2023
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '9ed8142e-77d2-4580-85f4-2eb3d89ec7e2',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'b7755b8c-68a5-4f89-b9e8-e5eafb6935e5',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'c1575d11-09e5-468c-9c31-dccd1f2321d6',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1141992
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'MGdXEzwP6HuZx3nLr2Ln',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Tuborg Beer. Total so far: 3
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 4/5: Vero Mop
üçå Item ID: 1Z3uI3OL04X5mOw0K0wC
üçå Direct product extraction for: Vero Mop
üçå Item details: {
  id: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  productNameMk: '–í–µ—Ä–æ –ú–æ–ø'
}
üçå Built enhanced prompt for Vero Mop
üçå Generated prompt for Vero Mop
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2017
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2017
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'db9ae8d8-55db-46fb-aefc-d617a92ca070',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '9cad1ed6-7017-4b31-b753-bbe2bc19b453',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 300040
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: '1Z3uI3OL04X5mOw0K0wC',
  productName: 'Vero Mop',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Vero Mop. Total so far: 4
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 5/5: Lazar Alur Gew√ºrztraminer
üçå Item ID: MfnrxqxvwAkl2PkD2vew
üçå Direct product extraction for: Lazar Alur Gew√ºrztraminer
üçå Item details: {
  id: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  productNameMk: '–õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
}
üçå Built enhanced prompt for Lazar Alur Gew√ºrztraminer
üçå Generated prompt for Lazar Alur Gew√ºrztraminer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2051
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2051
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '03d1c6b0-c930-4fd2-93fa-f9639e0603d2',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '855c61d5-ff08-4239-9386-99961327d4d3',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '66662286-03d0-403c-8426-f48f89726316',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 26ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 921000
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'MfnrxqxvwAkl2PkD2vew',
  productName: 'Lazar Alur Gew√ºrztraminer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Lazar Alur Gew√ºrztraminer. Total so far: 5
üçå FINAL RESULT: Successfully extracted 5 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: '9x2Ghrh6ctZDGfu7BJiB',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    hasImageUrl: true,
    imageUrlLength: 1243518,
    confidence: 0.95
  },
  {
    itemId: 'eBJTXkUgVmsg91pisFlZ',
    productName: 'Thomy Mayonnaise',
    hasImageUrl: true,
    imageUrlLength: 950434,
    confidence: 0.95
  },
  {
    itemId: 'MGdXEzwP6HuZx3nLr2Ln',
    productName: 'Tuborg Beer',
    hasImageUrl: true,
    imageUrlLength: 1142014,
    confidence: 0.95
  },
  {
    itemId: '1Z3uI3OL04X5mOw0K0wC',
    productName: 'Vero Mop',
    hasImageUrl: true,
    imageUrlLength: 300062,
    confidence: 0.95
  },
  {
    itemId: 'MfnrxqxvwAkl2PkD2vew',
    productName: 'Lazar Alur Gew√ºrztraminer',
    hasImageUrl: true,
    imageUrlLength: 921022,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 5
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HJ0457CXE5ECN44DW6BAGK result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HJ0414NRN1W3HT5ZT22GVE',
      name: 'flyer/extract-images',
      ts: 1758304669732,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HJ0457CXE5ECN44DW6BAGK',
    attempt: 3,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object], [Object], [Object] ]
  }
} +1m
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 82073ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'b695b181-4fb1-44b2-9e9e-accfa1dd10f3',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 30ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'df0d7262-2e14-45f5-8642-8b2c1a0fcc3d',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 21ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '9bdcbe6d-ee2b-40d3-8f27-5590934d72b2',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '4e5cd25d-1145-4594-865b-b2b59bc2f399',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '60efd3c6-a180-42a8-a714-5012d2eb4d4b',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 29ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'dcd0b3cc-291e-4e3e-a966-8789654ffc31',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'cede570c-06d2-4b22-9c40-85fd10bdd24b',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'e50e89f8-4526-4bff-9350-7a346a46a2ca',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'd0622d13-6d9e-4056-ab1f-0bd4ae4fed94',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '64a7549a-7ab3-4de7-9556-fbe675673788',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 29ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '24bb2175-2912-4299-b72e-9fa677952a34',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '48cdeb6e-6c39-4db5-bceb-ed97d4747934',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 26ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'c10fa883-bf27-47ad-9945-89c807f78b3c',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '2703fa9f-e3c9-452b-95a9-700694445b9a',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 22ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '5c9dd5bf-b1e7-4b6e-8817-380528f9a443',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 27ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '287e23e9-7753-4ff0-bda5-d15e041fcf41',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 28ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '77469dd1-567c-4157-b86b-2076783bbb23',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '871c9cde-1bd0-4253-8cd1-0f553e90f4b6',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 26ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'c9872d94-153e-4df0-965f-fbdc0d49976b',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 26ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '8ce161a3-466a-45a2-804d-d8d815743e89',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 31ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'a6707813-185b-4819-af15-9ee227a1a058',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 33ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '87a4d17a-63d5-41be-bc73-85bdc29610ad',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 30ms
