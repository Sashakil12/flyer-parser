  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +9s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 9386ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T starting V1 execution +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +4ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T executing step "check-auto-approval" +1ms
üîç Fetching all active auto-approval rules using admin SDK
‚úÖ Successfully updated parsed flyer item ZWSO6CtGHcR4r2cPiEqI
  inngest:01K5HKRHCH39HWPQ0S5G4S1YB5 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRHA5PNHQPPZJ7P7KSV81',
      name: 'flyer/product-match',
      ts: 1758306518341,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRHCH39HWPQ0S5G4S1YB5',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +617ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 640ms
  inngest:01K5HKRHCH39HWPQ0S5G4S1YB5 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRHCH39HWPQ0S5G4S1YB5 existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRHCH39HWPQ0S5G4S1YB5 starting V1 execution +0ms
  inngest:01K5HKRHCH39HWPQ0S5G4S1YB5 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'ZWSO6CtGHcR4r2cPiEqI',
    matchedProducts: 0,
    autoApproved: false
  }
} +3ms
  inngest:01K5HKRHCH39HWPQ0S5G4S1YB5 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRHA5PNHQPPZJ7P7KSV81',
      name: 'flyer/product-match',
      ts: 1758306518341,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRHCH39HWPQ0S5G4S1YB5',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'ZWSO6CtGHcR4r2cPiEqI',
    matchedProducts: 0,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 18ms
‚úÖ Found 1 active auto-approval rule(s).
üìù Fetching 1 parsed flyer items
‚úÖ Successfully fetched 1 parsed flyer items
‚úÖ Successfully uploaded all optimized images for item: Vo27HmoO0o9Df5Cjl7GW
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRAW668MSBGGX0ZQBK31D',
      name: 'flyer/extract-images',
      ts: 1758306511750,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRAZYPA39JKPPW6A5VCAC',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object] ]
  }
} +8s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 8112ms
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: '2cjFmOZ9fNCtgxV11KNl', itemCount: 2 }
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +3ms
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC executing step "update-database" +0ms
üìù Updating parsed flyer item bZblr3vsXCOuxXRW6Rkk
üìù Updating parsed flyer item Vo27HmoO0o9Df5Cjl7GW
‚úÖ Gemini API call completed at 2025-09-19T18:29:14.120Z
üìÑ Received response of length: 2147 characters
ü§ñ Raw Gemini response length: 2147
‚úÖ Found 9 valid matches after filtering
üèÅ Product matching completed with 9 matches
Match #1: productId=00P1AnRDmLigXbNmk9LQ, score=0.00, can_auto_merge=false
Match #2: productId=04NlBvxAeE4CUd3XqUhJ, score=0.00, can_auto_merge=false
Match #3: productId=32ceEIPBGP0bigSKU9nR, score=0.00, can_auto_merge=false
Match #4: productId=00GAOMXjQNgFXhjef5NA, score=0.00, can_auto_merge=false
Match #5: productId=015WZy9isbKoLpURfywP, score=0.00, can_auto_merge=false
Match #6: productId=017YNh2rj86Hd7A7zmoc, score=0.00, can_auto_merge=false
Match #7: productId=024JQwVkethXqfZ72B6g, score=0.00, can_auto_merge=false
Match #8: productId=02LJRT6qs5HsQj7Ce0u6, score=0.00, can_auto_merge=false
Match #9: productId=042NTZa93JKCVNQdgDrP, score=0.00, can_auto_merge=false
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRXXGKVDDABE4SPAFMMYB',
      name: 'flyer/product-match',
      ts: 1758306531248,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRY5D9SSWV6AF87FGXMVY',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +9s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 8529ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY starting V1 execution +1ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +3ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY executing step "check-auto-approval" +1ms
üîç Fetching all active auto-approval rules using admin SDK
‚úÖ Successfully uploaded all optimized images for item: Q4vlFRtwdHd61Gb0Ja3c
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Found 1 active auto-approval rule(s).
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRXXGKVDDABE4SPAFMMYB',
      name: 'flyer/product-match',
      ts: 1758306531248,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRY5D9SSWV6AF87FGXMVY',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'No suitable product matches found to evaluate against rules.',
      confidence: 0,
      productId: null
    }
  }
} +473ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 501ms
‚úÖ Successfully updated parsed flyer item Vo27HmoO0o9Df5Cjl7GW
‚úÖ Successfully updated parsed flyer item bZblr3vsXCOuxXRW6Rkk
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRAW668MSBGGX0ZQBK31D',
      name: 'flyer/extract-images',
      ts: 1758306511750,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRAZYPA39JKPPW6A5VCAC',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +733ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 781ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY starting V1 execution +0ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +7ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY executing step "save-matches-and-update-status" +5ms
üìù Updating parsed flyer item VXlvBbmjQNVOJoabTuTT
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: mVXbuxQX4ouoveSRD0wr
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: '2cjFmOZ9fNCtgxV11KNl', itemCount: 2 }
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: '2cjFmOZ9fNCtgxV11KNl',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +4ms
  inngest:01K5HKRAZYPA39JKPPW6A5VCAC result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRAW668MSBGGX0ZQBK31D',
      name: 'flyer/extract-images',
      ts: 1758306511750,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRAZYPA39JKPPW6A5VCAC',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: '2cjFmOZ9fNCtgxV11KNl',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 55ms
‚úÖ Successfully uploaded all optimized images for item: p3bO0T9NvGXsApvtR82U
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
üîç Update data structure check: {"matchedProducts":[],"matchingStatus":"completed","autoApprovalStatus":"failed","autoApprovalFailedAt":{"_seconds":1758306554,"_nanoseconds":928000000},"autoApprovalFailureReason":"No suitable produc...
‚úÖ Gemini API call completed at 2025-09-19T18:29:15.245Z
üìÑ Received response of length: 2012 characters
ü§ñ Raw Gemini response length: 2012
‚úÖ Found 9 valid matches after filtering
üèÅ Product matching completed with 9 matches
Match #1: productId=00P1AnRDmLigXbNmk9LQ, score=0.00, can_auto_merge=false
Match #2: productId=04NlBvxAeE4CUd3XqUhJ, score=0.00, can_auto_merge=false
Match #3: productId=32ceEIPBGP0bigSKU9nR, score=0.00, can_auto_merge=false
Match #4: productId=00GAOMXjQNgFXhjef5NA, score=0.00, can_auto_merge=false
Match #5: productId=015WZy9isbKoLpURfywP, score=0.00, can_auto_merge=false
Match #6: productId=017YNh2rj86Hd7A7zmoc, score=0.00, can_auto_merge=false
Match #7: productId=024JQwVkethXqfZ72B6g, score=0.00, can_auto_merge=false
Match #8: productId=02LJRT6qs5HsQj7Ce0u6, score=0.00, can_auto_merge=false
Match #9: productId=042NTZa93JKCVNQdgDrP, score=0.00, can_auto_merge=false
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1TC5QSVMM7H210FH0S',
      name: 'flyer/product-match',
      ts: 1758306523194,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2MNX8M3QYEX83ZGFCD',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +8s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 8001ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD starting V1 execution +0ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +2ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD executing step "check-auto-approval" +0ms
üîç Fetching all active auto-approval rules using admin SDK
‚úÖ Successfully updated parsed flyer item VXlvBbmjQNVOJoabTuTT
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRXXGKVDDABE4SPAFMMYB',
      name: 'flyer/product-match',
      ts: 1758306531248,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRY5D9SSWV6AF87FGXMVY',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +618ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 680ms
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: 9aTZu9s9wWsKXDCa27fU
‚úÖ Found 1 active auto-approval rule(s).
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1TC5QSVMM7H210FH0S',
      name: 'flyer/product-match',
      ts: 1758306523194,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2MNX8M3QYEX83ZGFCD',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'No suitable product matches found to evaluate against rules.',
      confidence: 0,
      productId: null
    }
  }
} +299ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 324ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY starting V1 execution +0ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'VXlvBbmjQNVOJoabTuTT',
    matchedProducts: 0,
    autoApproved: false
  }
} +3ms
  inngest:01K5HKRY5D9SSWV6AF87FGXMVY result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRXXGKVDDABE4SPAFMMYB',
      name: 'flyer/product-match',
      ts: 1758306531248,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRY5D9SSWV6AF87FGXMVY',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'VXlvBbmjQNVOJoabTuTT',
    matchedProducts: 0,
    autoApproved: false
  }
} +0ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 21ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'd83e31d6-7c33-49bc-ba43-e722e86dfd6d',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +1ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD starting V1 execution +0ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD executing step "save-matches-and-update-status" +1ms
üìù Updating parsed flyer item F04qj1JbVAn8Zz6VCLTL
üîç Update data structure check: {"matchedProducts":[],"matchingStatus":"completed","autoApprovalStatus":"failed","autoApprovalFailedAt":{"_seconds":1758306555,"_nanoseconds":816000000},"autoApprovalFailureReason":"No suitable produc...
‚úÖ Gemini API call completed at 2025-09-19T18:29:16.177Z
üìÑ Received response of length: 2617 characters
ü§ñ Raw Gemini response length: 2617
‚úÖ Found 9 valid matches after filtering
üèÅ Product matching completed with 9 matches
Match #1: productId=015WZy9isbKoLpURfywP, score=0.60, can_auto_merge=false
Match #2: productId=02LJRT6qs5HsQj7Ce0u6, score=0.50, can_auto_merge=false
Match #3: productId=00P1AnRDmLigXbNmk9LQ, score=0.00, can_auto_merge=false
Match #4: productId=04NlBvxAeE4CUd3XqUhJ, score=0.00, can_auto_merge=false
Match #5: productId=32ceEIPBGP0bigSKU9nR, score=0.00, can_auto_merge=false
Match #6: productId=00GAOMXjQNgFXhjef5NA, score=0.00, can_auto_merge=false
Match #7: productId=017YNh2rj86Hd7A7zmoc, score=0.00, can_auto_merge=false
Match #8: productId=024JQwVkethXqfZ72B6g, score=0.00, can_auto_merge=false
Match #9: productId=042NTZa93JKCVNQdgDrP, score=0.00, can_auto_merge=false
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRXY7WW5BW9715WYRD95N',
      name: 'flyer/product-match',
      ts: 1758306531271,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRY5RVWJ9AP1P6XNKX1T6',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +10s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 10281ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 starting V1 execution +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +3ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 executing step "check-auto-approval" +0ms
üîç Fetching all active auto-approval rules using admin SDK
‚úÖ Gemini API call completed at 2025-09-19T18:29:16.300Z
üìÑ Received response of length: 2219 characters
ü§ñ Raw Gemini response length: 2219
‚úÖ Found 9 valid matches after filtering
üèÅ Product matching completed with 9 matches
Match #1: productId=00P1AnRDmLigXbNmk9LQ, score=0.00, can_auto_merge=false
Match #2: productId=04NlBvxAeE4CUd3XqUhJ, score=0.00, can_auto_merge=false
Match #3: productId=32ceEIPBGP0bigSKU9nR, score=0.00, can_auto_merge=false
Match #4: productId=00GAOMXjQNgFXhjef5NA, score=0.00, can_auto_merge=false
Match #5: productId=015WZy9isbKoLpURfywP, score=0.00, can_auto_merge=false
Match #6: productId=017YNh2rj86Hd7A7zmoc, score=0.00, can_auto_merge=false
Match #7: productId=024JQwVkethXqfZ72B6g, score=0.00, can_auto_merge=false
Match #8: productId=02LJRT6qs5HsQj7Ce0u6, score=0.00, can_auto_merge=false
Match #9: productId=042NTZa93JKCVNQdgDrP, score=0.00, can_auto_merge=false
  inngest:01K5HKRP2C0GEVVPQ8W4552954 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1XWHPC1AAMWE83ZPRQ',
      name: 'flyer/product-match',
      ts: 1758306523197,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2C0GEVVPQ8W4552954',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +9s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 8608ms
‚úÖ Successfully uploaded all optimized images for item: ewNUh3EzklM7kur5RUuC
  inngest:01K5HKR9GDMQP0VF68G0BS99EE result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKR997VD6SQRKT0J6QQZS2',
      name: 'flyer/extract-images',
      ts: 1758306510119,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKR9GDMQP0VF68G0BS99EE',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object] ]
  }
} +6s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 6507ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 starting V1 execution +1ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +1ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 executing step "check-auto-approval" +1ms
üîç Fetching all active auto-approval rules using admin SDK
‚úÖ Successfully updated parsed flyer item F04qj1JbVAn8Zz6VCLTL
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1TC5QSVMM7H210FH0S',
      name: 'flyer/product-match',
      ts: 1758306523194,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2MNX8M3QYEX83ZGFCD',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +630ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 651ms
‚úÖ Gemini API call completed at 2025-09-19T18:29:16.530Z
üìÑ Received response of length: 2012 characters
ü§ñ Raw Gemini response length: 2012
‚úÖ Found 9 valid matches after filtering
üèÅ Product matching completed with 9 matches
Match #1: productId=00P1AnRDmLigXbNmk9LQ, score=0.00, can_auto_merge=false
Match #2: productId=04NlBvxAeE4CUd3XqUhJ, score=0.00, can_auto_merge=false
Match #3: productId=32ceEIPBGP0bigSKU9nR, score=0.00, can_auto_merge=false
Match #4: productId=00GAOMXjQNgFXhjef5NA, score=0.00, can_auto_merge=false
Match #5: productId=015WZy9isbKoLpURfywP, score=0.00, can_auto_merge=false
Match #6: productId=017YNh2rj86Hd7A7zmoc, score=0.00, can_auto_merge=false
Match #7: productId=024JQwVkethXqfZ72B6g, score=0.00, can_auto_merge=false
Match #8: productId=02LJRT6qs5HsQj7Ce0u6, score=0.00, can_auto_merge=false
Match #9: productId=042NTZa93JKCVNQdgDrP, score=0.00, can_auto_merge=false
  inngest:01K5HKRP2GG513HJGYDEG14TYJ result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1N4NQW84G74JFSVBA9',
      name: 'flyer/product-match',
      ts: 1758306523189,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2GG513HJGYDEG14TYJ',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
    op: 'StepRun',
    name: 'score-matches',
    opts: {},
    displayName: 'score-matches',
    data: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ]
  }
} +9s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 9140ms
‚úÖ Found 1 active auto-approval rule(s).
üìù Fetching 1 parsed flyer items
  inngest:01K5HKRP2GG513HJGYDEG14TYJ created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ existing state keys: [
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ starting V1 execution +1ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +1ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD starting V1 execution +0ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ executing step "check-auto-approval" +0ms
üîç Fetching all active auto-approval rules using admin SDK
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'F04qj1JbVAn8Zz6VCLTL',
    matchedProducts: 0,
    autoApproved: false
  }
} +6ms
  inngest:01K5HKRP2MNX8M3QYEX83ZGFCD result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1TC5QSVMM7H210FH0S',
      name: 'flyer/product-match',
      ts: 1758306523194,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2MNX8M3QYEX83ZGFCD',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'F04qj1JbVAn8Zz6VCLTL',
    matchedProducts: 0,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 47ms
  inngest:01K5HKR9GDMQP0VF68G0BS99EE created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKR9GDMQP0VF68G0BS99EE existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKR9GDMQP0VF68G0BS99EE starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'C5n9r6Ut5Uy2TXg5EflD', itemCount: 2 }
  inngest:01K5HKR9GDMQP0VF68G0BS99EE checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +2ms
  inngest:01K5HKR9GDMQP0VF68G0BS99EE executing step "update-database" +1ms
üìù Updating parsed flyer item r59bM7CwZ3gtqc1GEzZR
üìù Updating parsed flyer item ewNUh3EzklM7kur5RUuC
‚úÖ Found 1 active auto-approval rule(s).
  inngest:01K5HKRP2C0GEVVPQ8W4552954 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1XWHPC1AAMWE83ZPRQ',
      name: 'flyer/product-match',
      ts: 1758306523197,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2C0GEVVPQ8W4552954',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'No suitable product matches found to evaluate against rules.',
      confidence: 0,
      productId: null
    }
  }
} +289ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 310ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRJ84HMK4KFRY3AJ5WE38',
      name: 'flyer/product-match',
      ts: 1758306519300,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRJCAA23107ZSPFMBJ20T',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'The "name match" rule requires an exact match between the flyer item name and the database product name (case-insensitive).  The flyer item name is "Savex Premium Color & Care Detergent 5.5kg" while the database product name is "Savex Premium Fresh Universal Detergent 5.5kg". These names are not an exact match due to the words "Color & Care" vs. "Fresh Universal". Therefore, the auto-approval rule is not met.',
      confidence: 0.7,
      productId: null
    }
  }
} +4s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 3541ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T starting V1 execution +0ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 starting V1 execution +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +5ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T executing step "save-matches-and-update-status" +1ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 executing step "save-matches-and-update-status" +1ms
üìù Updating parsed flyer item p3bO0T9NvGXsApvtR82U
üìù Updating parsed flyer item k0dD8jBI3GYk0wUD88HI
‚úÖ Successfully fetched 1 parsed flyer items
‚úÖ Found 1 active auto-approval rule(s).
  inngest:01K5HKRP2GG513HJGYDEG14TYJ result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1N4NQW84G74JFSVBA9',
      name: 'flyer/product-match',
      ts: 1758306523189,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2GG513HJGYDEG14TYJ',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'No suitable product matches found to evaluate against rules.',
      confidence: 0,
      productId: null
    }
  }
} +296ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 341ms
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
  inngest:01K5HKRP2GG513HJGYDEG14TYJ created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +1ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ starting V1 execution +0ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +1ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ executing step "save-matches-and-update-status" +1ms
üìù Updating parsed flyer item HTRsmvPd08yig6GGEth7
üîç Update data structure check: {"matchedProducts":[],"matchingStatus":"completed","autoApprovalStatus":"failed","autoApprovalFailedAt":{"_seconds":1758306556,"_nanoseconds":869000000},"autoApprovalFailureReason":"No suitable produc...
üîç Update data structure check: {"matchedProducts":[{"productId":"00GAOMXjQNgFXhjef5NA","relevanceScore":0.7,"matchReason":"Same brand, size, and category. 'Premium' variant matches, but 'Color & Care' vs. 'Fresh Universal' is a sig...
‚úÖ Successfully updated parsed flyer item r59bM7CwZ3gtqc1GEzZR
‚úÖ Successfully updated parsed flyer item ewNUh3EzklM7kur5RUuC
  inngest:01K5HKR9GDMQP0VF68G0BS99EE result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKR997VD6SQRKT0J6QQZS2',
      name: 'flyer/extract-images',
      ts: 1758306510119,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKR9GDMQP0VF68G0BS99EE',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +607ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 654ms
üîç Update data structure check: {"matchedProducts":[],"matchingStatus":"completed","autoApprovalStatus":"failed","autoApprovalFailedAt":{"_seconds":1758306557,"_nanoseconds":8000000},"autoApprovalFailureReason":"No suitable product ...
  inngest:01K5HKR9GDMQP0VF68G0BS99EE created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKR9GDMQP0VF68G0BS99EE existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKR9GDMQP0VF68G0BS99EE starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'C5n9r6Ut5Uy2TXg5EflD', itemCount: 2 }
  inngest:01K5HKR9GDMQP0VF68G0BS99EE checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'C5n9r6Ut5Uy2TXg5EflD',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +5ms
  inngest:01K5HKR9GDMQP0VF68G0BS99EE result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKR997VD6SQRKT0J6QQZS2',
      name: 'flyer/extract-images',
      ts: 1758306510119,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKR9GDMQP0VF68G0BS99EE',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'C5n9r6Ut5Uy2TXg5EflD',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 48ms
‚úÖ Successfully uploaded all optimized images for item: mVXbuxQX4ouoveSRD0wr
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRFNVKZ17ZTP81JCWG893',
      name: 'flyer/extract-images',
      ts: 1758306516667,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRFXFYGTF67CTJBKV0XMV',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object] ]
  }
} +7s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 6822ms
‚úÖ Successfully updated parsed flyer item k0dD8jBI3GYk0wUD88HI
  inngest:01K5HKRP2C0GEVVPQ8W4552954 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1XWHPC1AAMWE83ZPRQ',
      name: 'flyer/product-match',
      ts: 1758306523197,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2C0GEVVPQ8W4552954',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +609ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 633ms
‚úÖ Successfully updated parsed flyer item p3bO0T9NvGXsApvtR82U
  inngest:01K5HKRJCAA23107ZSPFMBJ20T result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRJ84HMK4KFRY3AJ5WE38',
      name: 'flyer/product-match',
      ts: 1758306519300,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRJCAA23107ZSPFMBJ20T',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +684ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 709ms
‚úÖ Successfully updated parsed flyer item HTRsmvPd08yig6GGEth7
  inngest:01K5HKRP2GG513HJGYDEG14TYJ result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1N4NQW84G74JFSVBA9',
      name: 'flyer/product-match',
      ts: 1758306523189,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2GG513HJGYDEG14TYJ',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +601ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 618ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T starting V1 execution +0ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 starting V1 execution +0ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'p3bO0T9NvGXsApvtR82U',
    matchedProducts: 2,
    autoApproved: false
  }
} +6ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'k0dD8jBI3GYk0wUD88HI',
    matchedProducts: 0,
    autoApproved: false
  }
} +5ms
  inngest:01K5HKRJCAA23107ZSPFMBJ20T result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRJ84HMK4KFRY3AJ5WE38',
      name: 'flyer/product-match',
      ts: 1758306519300,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRJCAA23107ZSPFMBJ20T',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'p3bO0T9NvGXsApvtR82U',
    matchedProducts: 2,
    autoApproved: false
  }
} +1ms
  inngest:01K5HKRP2C0GEVVPQ8W4552954 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1XWHPC1AAMWE83ZPRQ',
      name: 'flyer/product-match',
      ts: 1758306523197,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2C0GEVVPQ8W4552954',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'k0dD8jBI3GYk0wUD88HI',
    matchedProducts: 0,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 33ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 33ms
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +1ms
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'Ae528remPAuewFWjLmYu', itemCount: 2 }
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +3ms
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV executing step "update-database" +0ms
üìù Updating parsed flyer item Q4vlFRtwdHd61Gb0Ja3c
üìù Updating parsed flyer item mVXbuxQX4ouoveSRD0wr
  inngest:01K5HKRP2GG513HJGYDEG14TYJ created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ starting V1 execution +0ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: 'HTRsmvPd08yig6GGEth7',
    matchedProducts: 0,
    autoApproved: false
  }
} +4ms
  inngest:01K5HKRP2GG513HJGYDEG14TYJ result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRP1N4NQW84G74JFSVBA9',
      name: 'flyer/product-match',
      ts: 1758306523189,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRP2GG513HJGYDEG14TYJ',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: 'HTRsmvPd08yig6GGEth7',
    matchedProducts: 0,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 23ms
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully updated parsed flyer item mVXbuxQX4ouoveSRD0wr
‚úÖ Successfully updated parsed flyer item Q4vlFRtwdHd61Gb0Ja3c
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRFNVKZ17ZTP81JCWG893',
      name: 'flyer/extract-images',
      ts: 1758306516667,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRFXFYGTF67CTJBKV0XMV',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +627ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 673ms
‚úÖ Successfully uploaded all optimized images for item: 9aTZu9s9wWsKXDCa27fU
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRK8D0EAMFF4VWDT5YHXZ',
      name: 'flyer/extract-images',
      ts: 1758306520333,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRKC3MMA5M2P5XMA9NJQ1',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object] ]
  }
} +6s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 6150ms
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'Ae528remPAuewFWjLmYu', itemCount: 2 }
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'Ae528remPAuewFWjLmYu',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +1ms
  inngest:01K5HKRFXFYGTF67CTJBKV0XMV result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRFNVKZ17ZTP81JCWG893',
      name: 'flyer/extract-images',
      ts: 1758306516667,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRFXFYGTF67CTJBKV0XMV',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'Ae528remPAuewFWjLmYu',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 37ms
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'Gn6LDMHhZf4yOX0jvOA8', itemCount: 2 }
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +2ms
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 executing step "update-database" +0ms
üìù Updating parsed flyer item p3bO0T9NvGXsApvtR82U
üìù Updating parsed flyer item 9aTZu9s9wWsKXDCa27fU
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully updated parsed flyer item 9aTZu9s9wWsKXDCa27fU
‚úÖ Successfully updated parsed flyer item p3bO0T9NvGXsApvtR82U
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRK8D0EAMFF4VWDT5YHXZ',
      name: 'flyer/extract-images',
      ts: 1758306520333,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRKC3MMA5M2P5XMA9NJQ1',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +691ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 763ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRXY7WW5BW9715WYRD95N',
      name: 'flyer/product-match',
      ts: 1758306531271,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRY5RVWJ9AP1P6XNKX1T6',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '264b57991efed85f2e14313161ab14957e9cb996',
    op: 'StepRun',
    name: 'check-auto-approval',
    opts: {},
    displayName: 'check-auto-approval',
    data: {
      shouldAutoApprove: false,
      reasoning: 'The "name match" rule requires an exact match between the flyer item name and the database product name (case-insensitive).  The flyer item name is "Ovce Brisa 3kg" while the database product name is "Health mixed cheese 1kg". These names are not an exact match. Therefore, the auto-approval rule is not satisfied.',
      confidence: 0.6,
      productId: null
    }
  }
} +3s
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 3156ms
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +1ms
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'Gn6LDMHhZf4yOX0jvOA8', itemCount: 2 }
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'Gn6LDMHhZf4yOX0jvOA8',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +5ms
  inngest:01K5HKRKC3MMA5M2P5XMA9NJQ1 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRK8D0EAMFF4VWDT5YHXZ',
      name: 'flyer/extract-images',
      ts: 1758306520333,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRKC3MMA5M2P5XMA9NJQ1',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'Gn6LDMHhZf4yOX0jvOA8',
    totalItems: 2,
    extractedImages: 2,
    failedExtractions: 0
  }
} +0ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 53ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 starting V1 execution +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +2ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 executing step "save-matches-and-update-status" +1ms
üìù Updating parsed flyer item 4eSrKGbRlcDT7sVhR98H
üîç Update data structure check: {"matchedProducts":[{"productId":"015WZy9isbKoLpURfywP","relevanceScore":0.6,"matchReason":"Both are cheese products, but different types (mixed cheese vs. Brisa). Weights match.","can_auto_merge":fal...
‚úÖ Successfully updated parsed flyer item 4eSrKGbRlcDT7sVhR98H
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRXY7WW5BW9715WYRD95N',
      name: 'flyer/product-match',
      ts: 1758306531271,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRY5RVWJ9AP1P6XNKX1T6',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
    op: 'StepRun',
    name: 'save-matches-and-update-status',
    opts: {},
    displayName: 'save-matches-and-update-status',
    data: null
  }
} +637ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 206 in 659ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 existing state keys: [
  '264b57991efed85f2e14313161ab14957e9cb996',
  '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
  '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
  'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
  'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d'
] +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 starting V1 execution +0ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    parsedItemId: '4eSrKGbRlcDT7sVhR98H',
    matchedProducts: 2,
    autoApproved: false
  }
} +2ms
  inngest:01K5HKRY5RVWJ9AP1P6XNKX1T6 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRXY7WW5BW9715WYRD95N',
      name: 'flyer/product-match',
      ts: 1758306531271,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRY5RVWJ9AP1P6XNKX1T6',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-to-processing': {
      id: 'update-status-to-processing',
      op: 'StepPlanned',
      name: 'update-status-to-processing',
      displayName: 'update-status-to-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'd00ed8ad3f033bcbd62b1f182ab7fd0abc152f5d',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'search-products': {
      id: 'search-products',
      op: 'StepPlanned',
      name: 'search-products',
      displayName: 'search-products',
      opts: {},
      rawArgs: [Array],
      hashedId: '68c878c636e3b59bb8a58c6dfa4fe6c333d685d5',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'score-matches': {
      id: 'score-matches',
      op: 'StepPlanned',
      name: 'score-matches',
      displayName: 'score-matches',
      opts: {},
      rawArgs: [Array],
      hashedId: '59fbb86e379cc6e59609c356a33c3a8e50976aeb',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'check-auto-approval': {
      id: 'check-auto-approval',
      op: 'StepPlanned',
      name: 'check-auto-approval',
      displayName: 'check-auto-approval',
      opts: {},
      rawArgs: [Array],
      hashedId: '264b57991efed85f2e14313161ab14957e9cb996',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'save-matches-and-update-status': {
      id: 'save-matches-and-update-status',
      op: 'StepPlanned',
      name: 'save-matches-and-update-status',
      displayName: 'save-matches-and-update-status',
      opts: {},
      rawArgs: [Array],
      hashedId: 'ce80c71e0696a84a721850ca5a0486f0e48ab5f4',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    parsedItemId: '4eSrKGbRlcDT7sVhR98H',
    matchedProducts: 2,
    autoApproved: false
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-match-products&stepId=step 200 in 22ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '6733cd8b-455f-4cce-98e2-80b9c70428a9',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 22ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1055744
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'vFgzjwMh2SDn420elGGU',
  productName: 'Ariel Pods 60/1',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'vFgzjwMh2SDn420elGGU',
  productName: 'Ariel Pods 60/1',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Ariel Pods 60/1. Total so far: 3
üçå FINAL RESULT: Successfully extracted 3 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: 'ELN1nl30liYO1OJSS2SG',
    productName: 'Ariel Powder 5.2kg',
    hasImageUrl: true,
    imageUrlLength: 1216054,
    confidence: 0.95
  },
  {
    itemId: 'NGC8GqYX1QVJWi8aMu7S',
    productName: 'Ariel Liquid 3.6L',
    hasImageUrl: true,
    imageUrlLength: 1014842,
    confidence: 0.95
  },
  {
    itemId: 'vFgzjwMh2SDn420elGGU',
    productName: 'Ariel Pods 60/1',
    hasImageUrl: true,
    imageUrlLength: 1055766,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 3
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRC7SYRNZYE7PEDMZJP8F',
      name: 'flyer/extract-images',
      ts: 1758306513145,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRCFJTWERK6WA8FG1HB50',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object] ]
  }
} +46s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 46263ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'LpANIuRNICbEBfjSzYU4', itemCount: 3 }
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +3ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 executing step "process-images" +0ms
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: ELN1nl30liYO1OJSS2SG
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1092596
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'F04qj1JbVAn8Zz6VCLTL',
  productName: 'Jacobs Cronat Gold Instant Coffee 100g',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'F04qj1JbVAn8Zz6VCLTL',
  productName: 'Jacobs Cronat Gold Instant Coffee 100g',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Jacobs Cronat Gold Instant Coffee 100g. Total so far: 2
‚è≥ Rate limiting: waiting 1500ms before next API call...
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 841204
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'O5NnhNzor8hU3kXVAHoL',
  productName: 'Paragon By the River Temjanika Wine',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'O5NnhNzor8hU3kXVAHoL',
  productName: 'Paragon By the River Temjanika Wine',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Paragon By the River Temjanika Wine. Total so far: 3
üçå FINAL RESULT: Successfully extracted 3 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: 'ZWSO6CtGHcR4r2cPiEqI',
    productName: 'Paragon By the River Zupljanka Wine',
    hasImageUrl: true,
    imageUrlLength: 389982,
    confidence: 0.95
  },
  {
    itemId: 'HQ52VSdeKWEr3mpw2Q0m',
    productName: 'Paragon La Vie en Rose Wine',
    hasImageUrl: true,
    imageUrlLength: 854566,
    confidence: 0.95
  },
  {
    itemId: 'O5NnhNzor8hU3kXVAHoL',
    productName: 'Paragon By the River Temjanika Wine',
    hasImageUrl: true,
    imageUrlLength: 841226,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 3
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRJ87DF7F0S09V3G4ASM2',
      name: 'flyer/extract-images',
      ts: 1758306519303,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRJCMA9Z6ATASXTBVTZYQ',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object] ]
  }
} +41s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 41536ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'WIWmpyHcmqrGyYAQ0LzV', itemCount: 3 }
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +2ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ executing step "process-images" +0ms
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: ZWSO6CtGHcR4r2cPiEqI
‚úÖ Successfully uploaded all optimized images for item: ELN1nl30liYO1OJSS2SG
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
üçå Processing item 3/3: Jacobs Crema Instant Coffee 100g
üçå Item ID: k0dD8jBI3GYk0wUD88HI
üçå Direct product extraction for: Jacobs Crema Instant Coffee 100g
üçå Item details: {
  id: 'k0dD8jBI3GYk0wUD88HI',
  productName: 'Jacobs Crema Instant Coffee 100g',
  productNameMk: '–à–∞–∫–æ–±—Å –ö—Ä–µ–º–∞ –ò–Ω—Å—Ç–∞–Ω—Ç –ö–∞—Ñ–µ 100–≥'
}
üçå Built enhanced prompt for Jacobs Crema Instant Coffee 100g
üçå Generated prompt for Jacobs Crema Instant Coffee 100g
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2063
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2063
üçå Base64 data length: 134920
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: NGC8GqYX1QVJWi8aMu7S
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '13667c91-2bfd-4eb7-a024-d3c31cb841d8',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1058332
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'VXlvBbmjQNVOJoabTuTT',
  productName: 'Thomy Mayonnaise 611g',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'VXlvBbmjQNVOJoabTuTT',
  productName: 'Thomy Mayonnaise 611g',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Thomy Mayonnaise 611g. Total so far: 2
‚è≥ Rate limiting: waiting 1500ms before next API call...
‚úÖ Successfully uploaded all optimized images for item: ZWSO6CtGHcR4r2cPiEqI
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Successfully uploaded all optimized images for item: NGC8GqYX1QVJWi8aMu7S
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: HQ52VSdeKWEr3mpw2Q0m
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: vFgzjwMh2SDn420elGGU
üçå Processing item 3/5: Tuborg Beer
üçå Item ID: Hq8UhltcaaTg5mIXFP4n
üçå Direct product extraction for: Tuborg Beer
üçå Item details: {
  id: 'Hq8UhltcaaTg5mIXFP4n',
  productName: 'Tuborg Beer',
  productNameMk: '–ü–∏–≤–æ –¢—É–±–æ—Ä–≥'
}
üçå Built enhanced prompt for Tuborg Beer
üçå Generated prompt for Tuborg Beer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2023
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2023
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚úÖ Successfully uploaded all optimized images for item: HQ52VSdeKWEr3mpw2Q0m
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: O5NnhNzor8hU3kXVAHoL
‚úÖ Successfully uploaded all optimized images for item: vFgzjwMh2SDn420elGGU
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRC7SYRNZYE7PEDMZJP8F',
      name: 'flyer/extract-images',
      ts: 1758306513145,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRCFJTWERK6WA8FG1HB50',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object], [Object] ]
  }
} +9s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 8717ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'LpANIuRNICbEBfjSzYU4', itemCount: 3 }
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +4ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 executing step "update-database" +1ms
üìù Updating parsed flyer item ELN1nl30liYO1OJSS2SG
üìù Updating parsed flyer item NGC8GqYX1QVJWi8aMu7S
üìù Updating parsed flyer item vFgzjwMh2SDn420elGGU
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '68db6451-3209-4577-b4d3-07180f2b6837',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 19ms
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully updated parsed flyer item NGC8GqYX1QVJWi8aMu7S
‚úÖ Successfully updated parsed flyer item ELN1nl30liYO1OJSS2SG
‚úÖ Successfully updated parsed flyer item vFgzjwMh2SDn420elGGU
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRC7SYRNZYE7PEDMZJP8F',
      name: 'flyer/extract-images',
      ts: 1758306513145,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRCFJTWERK6WA8FG1HB50',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +639ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 684ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'LpANIuRNICbEBfjSzYU4', itemCount: 3 }
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'LpANIuRNICbEBfjSzYU4',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +2ms
  inngest:01K5HKRCFJTWERK6WA8FG1HB50 result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRC7SYRNZYE7PEDMZJP8F',
      name: 'flyer/extract-images',
      ts: 1758306513145,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRCFJTWERK6WA8FG1HB50',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'LpANIuRNICbEBfjSzYU4',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 51ms
‚úÖ Successfully uploaded all optimized images for item: O5NnhNzor8hU3kXVAHoL
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRJ87DF7F0S09V3G4ASM2',
      name: 'flyer/extract-images',
      ts: 1758306519303,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRJCMA9Z6ATASXTBVTZYQ',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object], [Object] ]
  }
} +8s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 8300ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +1ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'WIWmpyHcmqrGyYAQ0LzV', itemCount: 3 }
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +2ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ executing step "update-database" +1ms
üìù Updating parsed flyer item ZWSO6CtGHcR4r2cPiEqI
üìù Updating parsed flyer item HQ52VSdeKWEr3mpw2Q0m
üìù Updating parsed flyer item O5NnhNzor8hU3kXVAHoL
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully updated parsed flyer item HQ52VSdeKWEr3mpw2Q0m
‚úÖ Successfully updated parsed flyer item O5NnhNzor8hU3kXVAHoL
‚úÖ Successfully updated parsed flyer item ZWSO6CtGHcR4r2cPiEqI
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRJ87DF7F0S09V3G4ASM2',
      name: 'flyer/extract-images',
      ts: 1758306519303,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRJCMA9Z6ATASXTBVTZYQ',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +617ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 658ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'WIWmpyHcmqrGyYAQ0LzV', itemCount: 3 }
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'WIWmpyHcmqrGyYAQ0LzV',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +3ms
  inngest:01K5HKRJCMA9Z6ATASXTBVTZYQ result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRJ87DF7F0S09V3G4ASM2',
      name: 'flyer/extract-images',
      ts: 1758306519303,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRJCMA9Z6ATASXTBVTZYQ',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'WIWmpyHcmqrGyYAQ0LzV',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +0ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 52ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '1589b1b8-6f5c-47c2-bb55-3d6834085adf',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1156584
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'k0dD8jBI3GYk0wUD88HI',
  productName: 'Jacobs Crema Instant Coffee 100g',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'k0dD8jBI3GYk0wUD88HI',
  productName: 'Jacobs Crema Instant Coffee 100g',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Jacobs Crema Instant Coffee 100g. Total so far: 3
üçå FINAL RESULT: Successfully extracted 3 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: 'HTRsmvPd08yig6GGEth7',
    productName: 'Jacobs Monarch Instant Coffee 100g',
    hasImageUrl: true,
    imageUrlLength: 1034830,
    confidence: 0.95
  },
  {
    itemId: 'F04qj1JbVAn8Zz6VCLTL',
    productName: 'Jacobs Cronat Gold Instant Coffee 100g',
    hasImageUrl: true,
    imageUrlLength: 1092618,
    confidence: 0.95
  },
  {
    itemId: 'k0dD8jBI3GYk0wUD88HI',
    productName: 'Jacobs Crema Instant Coffee 100g',
    hasImageUrl: true,
    imageUrlLength: 1156606,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 3
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRQ82585Q62EEEGQW7KJC',
      name: 'flyer/extract-images',
      ts: 1758306524418,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRQ9Y13CTV9WC119QK2WF',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object] ]
  }
} +44s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 44947ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'ED1IcYMcHrvHMtt47H1I', itemCount: 3 }
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +3ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF executing step "process-images" +1ms
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: HTRsmvPd08yig6GGEth7
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1120020
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'Hq8UhltcaaTg5mIXFP4n',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'Hq8UhltcaaTg5mIXFP4n',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Tuborg Beer. Total so far: 3
‚è≥ Rate limiting: waiting 1500ms before next API call...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'cf0275fa-437f-4672-ba34-ab40913569a4',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
üçå Processing item 4/5: Vino Lazar Alur Gewurztraminer
üçå Item ID: xBTXVpDlThMAfvRAGeP9
üçå Direct product extraction for: Vino Lazar Alur Gewurztraminer
üçå Item details: {
  id: 'xBTXVpDlThMAfvRAGeP9',
  productName: 'Vino Lazar Alur Gewurztraminer',
  productNameMk: '–í–∏–Ω–æ –õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
}
üçå Built enhanced prompt for Vino Lazar Alur Gewurztraminer
üçå Generated prompt for Vino Lazar Alur Gewurztraminer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2061
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2061
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚úÖ Successfully uploaded all optimized images for item: HTRsmvPd08yig6GGEth7
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: F04qj1JbVAn8Zz6VCLTL
‚úÖ Successfully uploaded all optimized images for item: F04qj1JbVAn8Zz6VCLTL
üîß Optimizing image for Flutter app...
üìê Original image: 1408x736
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '513a1301-3216-47f5-90d6-6d8a38484560',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
‚úÖ Image optimization completed
üì§ Uploading optimized images for item: k0dD8jBI3GYk0wUD88HI
‚úÖ Successfully uploaded all optimized images for item: k0dD8jBI3GYk0wUD88HI
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRQ82585Q62EEEGQW7KJC',
      name: 'flyer/extract-images',
      ts: 1758306524418,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRQ9Y13CTV9WC119QK2WF',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'b08c823461ca48509499962c6696b140624e3baf',
    op: 'StepRun',
    name: 'process-images',
    opts: {},
    displayName: 'process-images',
    data: [ [Object], [Object], [Object] ]
  }
} +11s
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 10886ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +1ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'ED1IcYMcHrvHMtt47H1I', itemCount: 3 }
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +4ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF executing step "update-database" +1ms
üìù Updating parsed flyer item HTRsmvPd08yig6GGEth7
üìù Updating parsed flyer item F04qj1JbVAn8Zz6VCLTL
üìù Updating parsed flyer item k0dD8jBI3GYk0wUD88HI
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
üîç Update data structure check: {"extractedImages":{"clean":{},"resolutions":{},"extractionMetadata":{"confidence":0.95,"backgroundRemoved":true,"textRemoved":true,"qualityScore":0.9,"processingMethod":"nano-banana","manualReviewReq...
‚úÖ Successfully updated parsed flyer item k0dD8jBI3GYk0wUD88HI
‚úÖ Successfully updated parsed flyer item HTRsmvPd08yig6GGEth7
‚úÖ Successfully updated parsed flyer item F04qj1JbVAn8Zz6VCLTL
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRQ82585Q62EEEGQW7KJC',
      name: 'flyer/extract-images',
      ts: 1758306524418,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRQ9Y13CTV9WC119QK2WF',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
    op: 'StepRun',
    name: 'update-database',
    opts: {},
    displayName: 'update-database',
    data: null
  }
} +642ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 687ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF existing state keys: [
  '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'b08c823461ca48509499962c6696b140624e3baf',
  'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF starting V1 execution +1ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'ED1IcYMcHrvHMtt47H1I', itemCount: 3 }
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF checkpoint: {
  type: 'function-resolved',
  data: {
    success: true,
    flyerImageId: 'ED1IcYMcHrvHMtt47H1I',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +3ms
  inngest:01K5HKRQ9Y13CTV9WC119QK2WF result: {
  type: 'function-resolved',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKRQ82585Q62EEEGQW7KJC',
      name: 'flyer/extract-images',
      ts: 1758306524418,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKRQ9Y13CTV9WC119QK2WF',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'process-images': {
      id: 'process-images',
      op: 'StepPlanned',
      name: 'process-images',
      displayName: 'process-images',
      opts: {},
      rawArgs: [Array],
      hashedId: 'b08c823461ca48509499962c6696b140624e3baf',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'update-database': {
      id: 'update-database',
      op: 'StepPlanned',
      name: 'update-database',
      displayName: 'update-database',
      opts: {},
      rawArgs: [Array],
      hashedId: 'e0f23d67262f02c1db5f45aeb1e59b3f544b12e0',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    }
  },
  data: {
    success: true,
    flyerImageId: 'ED1IcYMcHrvHMtt47H1I',
    totalItems: 3,
    extractedImages: 3,
    failedExtractions: 0
  }
} +1ms
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 200 in 51ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'e22483aa-a3ad-41cd-b75f-af69d86d5dc1',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 118ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 803080
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'xBTXVpDlThMAfvRAGeP9',
  productName: 'Vino Lazar Alur Gewurztraminer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'xBTXVpDlThMAfvRAGeP9',
  productName: 'Vino Lazar Alur Gewurztraminer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Vino Lazar Alur Gewurztraminer. Total so far: 4
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 5/5: Ovce Brisa 3kg
üçå Item ID: 4eSrKGbRlcDT7sVhR98H
üçå Direct product extraction for: Ovce Brisa 3kg
üçå Item details: {
  id: '4eSrKGbRlcDT7sVhR98H',
  productName: 'Ovce Brisa 3kg',
  productNameMk: '–û–≤—á–µ –ë—Ä–∏—Å–∞ 3–∫–≥'
}
üçå Built enhanced prompt for Ovce Brisa 3kg
üçå Generated prompt for Ovce Brisa 3kg
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2029
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2029
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '755e8a34-a394-4be2-a5bd-6fb37017a90d',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '52207d29-e4ab-464d-9695-1d7e965e61ba',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 19ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'b9fd315b-bdfb-448b-bf71-7cc563d8698c',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 26ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1138024
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: '4eSrKGbRlcDT7sVhR98H',
  productName: 'Ovce Brisa 3kg',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: '4eSrKGbRlcDT7sVhR98H',
  productName: 'Ovce Brisa 3kg',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Ovce Brisa 3kg. Total so far: 5
üçå FINAL RESULT: Successfully extracted 5 clean product images with Nano Banana
üçå Final clean images array: [
  {
    itemId: 'xix6zWUVWaOJobHNqNl8',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    hasImageUrl: true,
    imageUrlLength: 1117530,
    confidence: 0.95
  },
  {
    itemId: 'VXlvBbmjQNVOJoabTuTT',
    productName: 'Thomy Mayonnaise 611g',
    hasImageUrl: true,
    imageUrlLength: 1058354,
    confidence: 0.95
  },
  {
    itemId: 'Hq8UhltcaaTg5mIXFP4n',
    productName: 'Tuborg Beer',
    hasImageUrl: true,
    imageUrlLength: 1120042,
    confidence: 0.95
  },
  {
    itemId: 'xBTXVpDlThMAfvRAGeP9',
    productName: 'Vino Lazar Alur Gewurztraminer',
    hasImageUrl: true,
    imageUrlLength: 803102,
    confidence: 0.95
  },
  {
    itemId: '4eSrKGbRlcDT7sVhR98H',
    productName: 'Ovce Brisa 3kg',
    hasImageUrl: true,
    imageUrlLength: 1138046,
    confidence: 0.95
  }
]
üçå NANO BANANA EXTRACTION SUMMARY:
   ‚úÖ Successful: 5
   ‚ùå Failed: 0
   üìä Success Rate: 100.0%
  inngest:01K5HKS04QE5N9C1A878NE4Z9J result: {
  type: 'step-ran',
  ctx: {
    event: {
      data: [Object],
      id: '01K5HKS00BKE3DRMY6ABT6X09X',
      name: 'flyer/extract-images',
      ts: 1758306533387,
      user: {}
    },
    events: [ [Object] ],
    runId: '01K5HKS04QE5N9C1A878NE4Z9J',
    attempt: 0,
    step: {
      sendEvent: [AsyncFunction (anonymous)],
      waitForSignal: [AsyncFunction (anonymous)],
      sendSignal: [AsyncFunction (anonymous)],
      waitForEvent: [AsyncFunction (anonymous)],
      run: [AsyncFunction (anonymous)],
      ai: [Object],
      sleep: [AsyncFunction (anonymous)],
      sleepUntil: [AsyncFunction (anonymous)],
      invoke: [AsyncFunction (anonymous)],
      fetch: [AsyncFunction],
      [Symbol(inngest.step.gateway)]: [AsyncFunction (anonymous)]
    },
    logger: ProxyLogger { enabled: true, logger: DefaultLogger {} }
  },
  ops: {
    'update-status-processing': {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'download-flyer-image': {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    'extract-with-ai': {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  },
  step: {
    id: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
    op: 'StepRun',
    name: 'extract-with-ai',
    opts: {},
    displayName: 'extract-with-ai',
    data: [ [Object], [Object], [Object], [Object], [Object] ]
  }
} +1m
 POST /api/inngest?fnId=badiyala-flyer-parser-extract-item-images&stepId=step 206 in 70573ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '977fbcea-5886-4838-aaa9-4951609abf50',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '38bb9ece-5fa6-43ce-9e51-a894e8e0143a',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 21ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '1daa420a-6e1e-4110-a556-e159f8a52730',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
  inngest:01K5HKS04QE5N9C1A878NE4Z9J created new V1 execution for run; discovering steps +0ms
  inngest:01K5HKS04QE5N9C1A878NE4Z9J existing state keys: [
  '6308f060992d543089232f1ba7f5b7d472f774a3',
  'f7da0e77dad8df9368c4406057dce67b98eed9fa'
] +0ms
  inngest:01K5HKS04QE5N9C1A878NE4Z9J starting V1 execution +0ms
üçå Starting image extraction with Nano Banana { flyerImageId: 'R6x3ylIXhf1CwEj3HY1Y', itemCount: 5 }
  inngest:01K5HKS04QE5N9C1A878NE4Z9J checkpoint: {
  type: 'steps-found',
  steps: [
    {
      id: 'update-status-processing',
      op: 'StepPlanned',
      name: 'update-status-processing',
      displayName: 'update-status-processing',
      opts: {},
      rawArgs: [Array],
      hashedId: 'f7da0e77dad8df9368c4406057dce67b98eed9fa',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'download-flyer-image',
      op: 'StepPlanned',
      name: 'download-flyer-image',
      displayName: 'download-flyer-image',
      opts: {},
      rawArgs: [Array],
      hashedId: '6308f060992d543089232f1ba7f5b7d472f774a3',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: true,
      hasStepState: true,
      handled: true,
      handle: [Function: handle]
    },
    {
      id: 'extract-with-ai',
      op: 'StepPlanned',
      name: 'extract-with-ai',
      displayName: 'extract-with-ai',
      opts: {},
      rawArgs: [Array],
      hashedId: '2b2a3ccef7e905efcd1a4dce6fe879c6d2f055ff',
      input: undefined,
      fn: [Function (anonymous)],
      promise: [Promise],
      fulfilled: false,
      hasStepState: false,
      handled: false,
      handle: [Function: handle]
    }
  ]
} +4ms
  inngest:01K5HKS04QE5N9C1A878NE4Z9J executing step "extract-with-ai" +1ms
üçå Starting NANO BANANA clean product image extraction for 5 items
üçå Config: {
  removeText: true,
  removePromotionalElements: true,
  backgroundStyle: 'white',
  productCentering: true,
  shadowGeneration: true,
  qualityEnhancement: true
}
üçå Flyer image data length: 277043
üçå Parsed items: [
  {
    id: 'xix6zWUVWaOJobHNqNl8',
    productName: 'Ariel Powder + Ariel Liquid (COMBO)',
    productNameMk: '–ê—Ä–∏–µ–ª –ü—Ä–∞–≤ + –ê—Ä–∏–µ–ª –¢–µ—á–µ–Ω (–ö–û–ú–ë–û)'
  },
  {
    id: 'VXlvBbmjQNVOJoabTuTT',
    productName: 'Thomy Mayonnaise 611g',
    productNameMk: '–ú–∞—ò–æ–Ω–µ–∑ –¢–æ–º–∏ 611–≥—Ä'
  },
  {
    id: 'Hq8UhltcaaTg5mIXFP4n',
    productName: 'Tuborg Beer',
    productNameMk: '–ü–∏–≤–æ –¢—É–±–æ—Ä–≥'
  },
  {
    id: 'xBTXVpDlThMAfvRAGeP9',
    productName: 'Vino Lazar Alur Gewurztraminer',
    productNameMk: '–í–∏–Ω–æ –õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
  },
  {
    id: '4eSrKGbRlcDT7sVhR98H',
    productName: 'Ovce Brisa 3kg',
    productNameMk: '–û–≤—á–µ –ë—Ä–∏—Å–∞ 3–∫–≥'
  }
]
üçå Processing item 1/5: Ariel Powder + Ariel Liquid (COMBO)
üçå Item ID: xix6zWUVWaOJobHNqNl8
üçå Direct product extraction for: Ariel Powder + Ariel Liquid (COMBO)
üçå Item details: {
  id: 'xix6zWUVWaOJobHNqNl8',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  productNameMk: '–ê—Ä–∏–µ–ª –ü—Ä–∞–≤ + –ê—Ä–∏–µ–ª –¢–µ—á–µ–Ω (–ö–û–ú–ë–û)'
}
üçå Built enhanced prompt for Ariel Powder + Ariel Liquid (COMBO)
üçå Generated prompt for Ariel Powder + Ariel Liquid (COMBO)
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2068
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2068
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '12847abc-f8dc-4f15-8210-63b1562b78ae',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 21ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '0e945681-1267-4964-9e7b-31434559bed2',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 20ms
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '96a392c6-91fb-4975-8ace-31177c8c1227',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 22ms
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1203532
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'xix6zWUVWaOJobHNqNl8',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'xix6zWUVWaOJobHNqNl8',
  productName: 'Ariel Powder + Ariel Liquid (COMBO)',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Ariel Powder + Ariel Liquid (COMBO). Total so far: 1
‚è≥ Rate limiting: waiting 1500ms before next API call...
üçå Processing item 2/5: Thomy Mayonnaise 611g
üçå Item ID: VXlvBbmjQNVOJoabTuTT
üçå Direct product extraction for: Thomy Mayonnaise 611g
üçå Item details: {
  id: 'VXlvBbmjQNVOJoabTuTT',
  productName: 'Thomy Mayonnaise 611g',
  productNameMk: '–ú–∞—ò–æ–Ω–µ–∑ –¢–æ–º–∏ 611–≥—Ä'
}
üçå Built enhanced prompt for Thomy Mayonnaise 611g
üçå Generated prompt for Thomy Mayonnaise 611g
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2040
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2040
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚è±Ô∏è Gemini API call timed out after 120 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': 'ea52b224-5753-4978-a946-ad264a9dfee4',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 25ms
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '54bd88fd-c28c-49d6-b7c7-79e49da22f2c',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1075992
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'VXlvBbmjQNVOJoabTuTT',
  productName: 'Thomy Mayonnaise 611g',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'VXlvBbmjQNVOJoabTuTT',
  productName: 'Thomy Mayonnaise 611g',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Thomy Mayonnaise 611g. Total so far: 2
‚è≥ Rate limiting: waiting 1500ms before next API call...
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '7f560028-9d35-4a47-adca-f853d47143ad',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 24ms
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
üçå Processing item 3/5: Tuborg Beer
üçå Item ID: Hq8UhltcaaTg5mIXFP4n
üçå Direct product extraction for: Tuborg Beer
üçå Item details: {
  id: 'Hq8UhltcaaTg5mIXFP4n',
  productName: 'Tuborg Beer',
  productNameMk: '–ü–∏–≤–æ –¢—É–±–æ—Ä–≥'
}
üçå Built enhanced prompt for Tuborg Beer
üçå Generated prompt for Tuborg Beer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2023
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2023
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '30088930-a7d4-44de-975e-d182d25a7785',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 19ms
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '8a473122-f7b5-42a8-a992-1ebdd20e6d08',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 23ms
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚úÖ Nano Banana API call successful for product-extraction
üçå API result structure: {
  hasPredictions: true,
  predictionsLength: 1,
  firstPredictionKeys: [ 'bytesBase64Encoded' ]
}
üçå Received base64 image data, length: 1101740
‚úÖ Successfully created image URL with Nano Banana
üçå API response: { success: true, hasImageUrl: true, error: undefined }
‚úÖ Successfully generated professional product image using Nano Banana
‚úÖ Created clean image object with Nano Banana: {
  itemId: 'Hq8UhltcaaTg5mIXFP4n',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  confidence: 0.95
}
üçå Received clean image: {
  itemId: 'Hq8UhltcaaTg5mIXFP4n',
  productName: 'Tuborg Beer',
  hasImageUrl: true,
  extractionMethod: 'nano-banana-direct'
}
‚úÖ Successfully added clean image for: Tuborg Beer. Total so far: 3
‚è≥ Rate limiting: waiting 1500ms before next API call...
‚è±Ô∏è Gemini API call timed out after 120 seconds
üçå Processing item 4/5: Vino Lazar Alur Gewurztraminer
üçå Item ID: xBTXVpDlThMAfvRAGeP9
üçå Direct product extraction for: Vino Lazar Alur Gewurztraminer
üçå Item details: {
  id: 'xBTXVpDlThMAfvRAGeP9',
  productName: 'Vino Lazar Alur Gewurztraminer',
  productNameMk: '–í–∏–Ω–æ –õ–∞–∑–∞—Ä –ê–ª—É—Ä –ì–µ–≤—É—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'
}
üçå Built enhanced prompt for Vino Lazar Alur Gewurztraminer
üçå Generated prompt for Vino Lazar Alur Gewurztraminer
üçå Calling Nano Banana API for product extraction...
üçå Prompt length: 2061
üçå Image data type: base64
üçå Calling Nano Banana API for operation: product-extraction (attempt 1/3)
üçå Prompt length: 2061
üçå Base64 data length: 277020
üçå MIME type: image/jpeg
üçå Generating content with Nano Banana...
‚è±Ô∏è Gemini API call timed out after 120 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '03b9834a-1f18-486c-9a8d-7c3e6aea66bf',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 22ms
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
‚è±Ô∏è Gemini API call timed out after 120 seconds
[Inngest] debug - registered inngest functions: 200 OK {
  ok: true,
  modified: false,
  'sync_id.omitempty': '115fb297-b5de-4651-a1ea-95ee320ad1d5',
  app_id: 'ed1dd999-5829-5a8a-b82a-e8258ddeb289'
}
 PUT /api/inngest 200 in 21ms
[Innge